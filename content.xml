<?xml version="1.0" encoding="utf-8"?>
<ode><userPreferences><userPreference><key>theme</key><value>base</value></userPreference></userPreferences><odeResources><odeResource><key>odeVersionId</key><value>20260206013613OHEBZI</value></odeResource><odeResource><key>odeId</key><value>20260113112139JBEBXX</value></odeResource><odeResource><key>odeVersionName</key><value>7</value></odeResource><odeResource><key>isDownload</key><value>true</value></odeResource><odeResource><key>eXeVersion</key><value>v3.0.2</value></odeResource></odeResources><odeProperties><odeProperty><key>pp_title</key><value>Data Logger con PHP y App Script</value></odeProperty><odeProperty><key>pp_subtitle</key><value>Registro y gestión de datos con PHP</value></odeProperty><odeProperty><key>pp_lang</key><value>es</value></odeProperty><odeProperty><key>pp_author</key><value/></odeProperty><odeProperty><key>license</key><value>creative commons: attribution - share alike 4.0</value></odeProperty><odeProperty><key>pp_description</key><value/></odeProperty><odeProperty><key>exportSource</key><value>true</value></odeProperty><odeProperty><key>pp_addExeLink</key><value>true</value></odeProperty><odeProperty><key>pp_addPagination</key><value>false</value></odeProperty><odeProperty><key>pp_addSearchBox</key><value>false</value></odeProperty><odeProperty><key>pp_addAccessibilityToolbar</key><value>false</value></odeProperty><odeProperty><key>pp_extraHeadContent</key><value/></odeProperty><odeProperty><key>footer</key><value/></odeProperty></odeProperties><odeNavStructures><odeNavStructure><odePageId>20260206013613ZQYUFD</odePageId><odeParentPageId/><pageName>Introducción y objetivos</pageName><odeNavStructureOrder>1</odeNavStructureOrder><odeNavStructureProperties><odeNavStructureProperty><key>titleNode</key><value>Introducción y objetivos</value></odeNavStructureProperty><odeNavStructureProperty><key>hidePageTitle</key><value>false</value></odeNavStructureProperty><odeNavStructureProperty><key>titleHtml</key><value/></odeNavStructureProperty><odeNavStructureProperty><key>editableInPage</key><value>false</value></odeNavStructureProperty><odeNavStructureProperty><key>titlePage</key><value>Introducción y objetivos</value></odeNavStructureProperty><odeNavStructureProperty><key>visibility</key><value>true</value></odeNavStructureProperty><odeNavStructureProperty><key>highlight</key><value>false</value></odeNavStructureProperty><odeNavStructureProperty><key>description</key><value/></odeNavStructureProperty></odeNavStructureProperties><odePagStructures><odePagStructure><odePageId>20260206013613ZQYUFD</odePageId><odeBlockId>20260206013613CKFBSI</odeBlockId><blockName>Data&amp;nbsp; Loggers</blockName><iconName/><odePagStructureOrder>1</odePagStructureOrder><odePagStructureProperties><odePagStructureProperty><key>visibility</key><value>true</value></odePagStructureProperty><odePagStructureProperty><key>teacherOnly</key><value>false</value></odePagStructureProperty><odePagStructureProperty><key>allowToggle</key><value>true</value></odePagStructureProperty><odePagStructureProperty><key>minimized</key><value>false</value></odePagStructureProperty><odePagStructureProperty><key>identifier</key><value/></odePagStructureProperty><odePagStructureProperty><key>cssClass</key><value/></odePagStructureProperty></odePagStructureProperties><odeComponents><odeComponent><odePageId>20260206013613ZQYUFD</odePageId><odeBlockId>20260206013613CKFBSI</odeBlockId><odeIdeviceId>2026012512320949279P</odeIdeviceId><odeIdeviceTypeName>text</odeIdeviceTypeName><htmlView>&lt;div class="exe-text-template"&gt;&lt;div class="textIdeviceContent"&gt;
            &lt;div class="exe-text-activity"&gt;
                &lt;div&gt;&lt;h2&gt;LA IMPORTANCIA DEL REGISTRO DE DATOS (DATA LOGGERS)&lt;/h2&gt;
&lt;p&gt;Los data loggers (registradores de datos) son dispositivos electrónicos que miden, almacenan y registran datos automáticamente a lo largo del tiempo. Su importancia radica en el monitoreo continuo y preciso,&amp;nbsp; permiten registrar variables como temperatura, humedad, presión, voltaje, luz o CO₂ de forma constante, etc.&amp;nbsp; En resumen, los data loggers son importantes porque garantizan control, seguridad, eficiencia y trazabilidad en procesos donde los datos confiables son críticos.&lt;/p&gt;
&lt;table&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td width="20%" style="text-align: justify;"&gt;&lt;img src="{{context_path}}/2026012512320949279P/images.jfif" width="225" height="225" alt=""&gt;&lt;/td&gt;
&lt;td&gt;
&lt;p&gt;Cada vez en más frecuente en nuestro día a día contar con dispositivos que registran información del entorno y generan una gran cantidad de datos. Normalmente, esa información se muestra en pantallas y no se registran en ninguna estructura de datos. En este documento se detallan distintas vías para almacenar y gestionar la información recogida..&lt;/p&gt;
&lt;p&gt;Nos vamos a centrar en las que almacenan la información en una base de datos (debemos tener acceso a un servidor de base de datos, ya sea en nuestro propio servidor o en alguna plataforma que nos ofrezan ese servicio). La&amp;nbsp; mayoría de los NAS incluyen dentro de sus paquetes un gestor de base de datos.&lt;/p&gt;
&lt;p&gt;Por otro lado, vamos también a estudiar la forma de enviar los datos a una hoja de cálculo de google sheets en tiempo real. Si bien, la cadencia de envío de datos no es comparable con la que se alcanza con un servidor propio. En google sheets se pueden alcanzar envíos de datos cada 2 o 3 segundos.&lt;/p&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Cada método de los citados tiene sus pros y contras que estudiaremos a lo largo de este documento. Y es uno de los objetivos de este trabajo, determinar qué método nos interesa para cada aplicación.&lt;/p&gt;
&lt;p&gt;Los objetivos específicos que pretendemos alcanzar son:&amp;nbsp;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Registro de los datos que adquirimos con nuestra sensorización&lt;/li&gt;
&lt;li&gt;Envío de datos de nuestro sistema de control a un ecosistema de datos&lt;/li&gt;
&lt;li&gt;Consulta configurable de los datos registrados&lt;/li&gt;
&lt;li&gt;Graficado de los datos adquiridos&lt;/li&gt;
&lt;li&gt;Graficado en tiempo real de los datos medidos&lt;/li&gt;
&lt;/ol&gt;&lt;p class="clearfix"&gt;&lt;/p&gt;&lt;/div&gt;
            &lt;/div&gt;&lt;/div&gt;&lt;/div&gt;</htmlView><jsonProperties>{"ideviceId":"2026012512320949279P","textInfoDurationInput":"","textInfoDurationTextInput":"Duración","textInfoParticipantsInput":"","textInfoParticipantsTextInput":"Agrupamiento","textTextarea":"&lt;h2&gt;LA IMPORTANCIA DEL REGISTRO DE DATOS (DATA LOGGERS)&lt;/h2&gt;\n&lt;p&gt;Los data loggers (registradores de datos) son dispositivos electrónicos que miden, almacenan y registran datos automáticamente a lo largo del tiempo. Su importancia radica en el monitoreo continuo y preciso,  permiten registrar variables como temperatura, humedad, presión, voltaje, luz o CO₂ de forma constante, etc.  En resumen, los data loggers son importantes porque garantizan control, seguridad, eficiencia y trazabilidad en procesos donde los datos confiables son críticos.&lt;/p&gt;\n&lt;table&gt;\n&lt;tbody&gt;\n&lt;tr&gt;\n&lt;td width=\"20%\" style=\"text-align: justify;\"&gt;&lt;img src=\"{{context_path}}/2026012512320949279P/images.jfif\" width=\"225\" height=\"225\" alt=\"\" /&gt;&lt;/td&gt;\n&lt;td&gt;\n&lt;p&gt;Cada vez en más frecuente en nuestro día a día contar con dispositivos que registran información del entorno y generan una gran cantidad de datos. Normalmente, esa información se muestra en pantallas y no se registran en ninguna estructura de datos. En este documento se detallan distintas vías para almacenar y gestionar la información recogida..&lt;/p&gt;\n&lt;p&gt;Nos vamos a centrar en las que almacenan la información en una base de datos (debemos tener acceso a un servidor de base de datos, ya sea en nuestro propio servidor o en alguna plataforma que nos ofrezan ese servicio). La  mayoría de los NAS incluyen dentro de sus paquetes un gestor de base de datos.&lt;/p&gt;\n&lt;p&gt;Por otro lado, vamos también a estudiar la forma de enviar los datos a una hoja de cálculo de google sheets en tiempo real. Si bien, la cadencia de envío de datos no es comparable con la que se alcanza con un servidor propio. En google sheets se pueden alcanzar envíos de datos cada 2 o 3 segundos.&lt;/p&gt;\n&lt;/td&gt;\n&lt;/tr&gt;\n&lt;/tbody&gt;\n&lt;/table&gt;\n&lt;p&gt;&lt;br /&gt;&lt;/p&gt;\n&lt;p&gt;Cada método de los citados tiene sus pros y contras que estudiaremos a lo largo de este documento. Y es uno de los objetivos de este trabajo, determinar qué método nos interesa para cada aplicación.&lt;/p&gt;\n&lt;p&gt;Los objetivos específicos que pretendemos alcanzar son: &lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;Registro de los datos que adquirimos con nuestra sensorización&lt;/li&gt;\n&lt;li&gt;Envío de datos de nuestro sistema de control a un ecosistema de datos&lt;/li&gt;\n&lt;li&gt;Consulta configurable de los datos registrados&lt;/li&gt;\n&lt;li&gt;Graficado de los datos adquiridos&lt;/li&gt;\n&lt;li&gt;Graficado en tiempo real de los datos medidos&lt;/li&gt;\n&lt;/ol&gt;","textFeedbackInput":"Mostrar retroalimentación","textFeedbackTextarea":""}</jsonProperties><odeComponentsOrder>1</odeComponentsOrder><odeComponentsProperties><odeComponentsProperty><key>visibility</key><value>true</value></odeComponentsProperty><odeComponentsProperty><key>teacherOnly</key><value>false</value></odeComponentsProperty><odeComponentsProperty><key>identifier</key><value/></odeComponentsProperty><odeComponentsProperty><key>cssClass</key><value/></odeComponentsProperty></odeComponentsProperties></odeComponent></odeComponents></odePagStructure></odePagStructures></odeNavStructure><odeNavStructure><odePageId>20260206013613XUUSJH</odePageId><odeParentPageId/><pageName>Registro datos y envío (POST y GET)</pageName><odeNavStructureOrder>2</odeNavStructureOrder><odeNavStructureProperties><odeNavStructureProperty><key>titleNode</key><value>Registro datos y envío (POST y GET)</value></odeNavStructureProperty><odeNavStructureProperty><key>hidePageTitle</key><value>false</value></odeNavStructureProperty><odeNavStructureProperty><key>titleHtml</key><value/></odeNavStructureProperty><odeNavStructureProperty><key>editableInPage</key><value>false</value></odeNavStructureProperty><odeNavStructureProperty><key>titlePage</key><value>Registro datos y envío (POST y GET)</value></odeNavStructureProperty><odeNavStructureProperty><key>visibility</key><value>true</value></odeNavStructureProperty><odeNavStructureProperty><key>highlight</key><value>false</value></odeNavStructureProperty><odeNavStructureProperty><key>description</key><value/></odeNavStructureProperty></odeNavStructureProperties><odePagStructures><odePagStructure><odePageId>20260206013613XUUSJH</odePageId><odeBlockId>20260206013613LAXHBR</odeBlockId><blockName>Toma y envío de datos</blockName><iconName/><odePagStructureOrder>1</odePagStructureOrder><odePagStructureProperties><odePagStructureProperty><key>visibility</key><value>true</value></odePagStructureProperty><odePagStructureProperty><key>teacherOnly</key><value>false</value></odePagStructureProperty><odePagStructureProperty><key>allowToggle</key><value>true</value></odePagStructureProperty><odePagStructureProperty><key>minimized</key><value>false</value></odePagStructureProperty><odePagStructureProperty><key>identifier</key><value/></odePagStructureProperty><odePagStructureProperty><key>cssClass</key><value/></odePagStructureProperty></odePagStructureProperties><odeComponents><odeComponent><odePageId>20260206013613XUUSJH</odePageId><odeBlockId>20260206013613LAXHBR</odeBlockId><odeIdeviceId>20260125130842676MET</odeIdeviceId><odeIdeviceTypeName>text</odeIdeviceTypeName><htmlView>&lt;div class="exe-text-template"&gt;&lt;div class="textIdeviceContent"&gt;
            &lt;div class="exe-text-activity"&gt;
                &lt;div&gt;&lt;h2&gt;REGISTRO Y ENVÍO DE DATOS&amp;nbsp;&lt;/h2&gt;
&lt;p&gt;PETICIONES GET Y POST&lt;/p&gt;
&lt;p&gt;&lt;img src="{{context_path}}/20260125130842676MET/infraestructura2.gif" width="650" height="218" alt=""&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Nuestro punto de partida un sistema de control sensorizado, el cual queremos registrar y tener acceso en tiempo real a los datos. Normalmente, los sistemas de control que se usan a nivel educativo tienen el potencial de poder ofrecernos la información en tiempo real a través de un pequeño servidor Web que se puede gestionar en la propia placa, pero no tienen la capacidad de gestionar un histórico de datos debido a la escasez de memoria de almacenamiento, por ello, esta posibilidad no la vamos a considerar.&lt;/p&gt;
&lt;p&gt;Una vez que tenemos las variables con los datos que deseamos registrar, vamos a construir una URL para madar la información a nuestro servidor. Esa solicitud la vamos a hacer a través de un petición GET, es más fácil de enterder que la POST, y nos vale para la mayoría de los casos. Esta solicitud tiene la siguiente estructura: &lt;a href="http://miDominio/mandaDatos.php?var1=dato1&amp;var2=dato2"&gt;http://miDominio/mandaDatos.php?var1=dato1&amp;var2=dato2&lt;/a&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Se puede deducir que mandaDatos.php es un script que elaboraremos ad hoc, y que las variables var1,var2, ... son las variables con sus respectivos valores (numéricas o alfanumerícas). A esa URL se accederá co el bloque GET que montramos bajo estas líneas si trabajamos con Steamakersblocks.&lt;/p&gt;
&lt;p&gt;&lt;img src="{{context_path}}/20260125130842676MET/BHTTPServer.png" width="275" height="86" alt=""&gt;&lt;/p&gt;
&lt;p&gt;Si trabajamos con el entorno IDE de arduino, el código a insertar sería&amp;nbsp; algo como lo que se muestra, una vez, claro esto, tenemos recopilados los datos y activada nuestra conexión WiFi.&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;#include &lt;httpclient.h&gt;&lt;/httpclient.h&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;&amp;nbsp; &amp;nbsp; HTTPClient http;&lt;br&gt;&amp;nbsp; &amp;nbsp; WiFiClient client;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;&amp;nbsp; &amp;nbsp; String url = "http://miDominio/mandaDatos.php?temperatura="+String(temp,2)+"&amp;humedad="+String(humedad,1);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;&amp;nbsp; &amp;nbsp; http.begin(client, url);&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;&amp;nbsp; &amp;nbsp; int httpCode = http.GET(); &amp;nbsp;// Realiza la petición&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;&amp;nbsp; &amp;nbsp; http.end();&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;&amp;nbsp; }&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;}&lt;/span&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;&lt;/span&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;El script PHP para añadir los datos a nuestra base de datos será el siguiente.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;&lt;?php&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;// Datos de conexión a la base de datos&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;$servidor = "localhost";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;$usuario &amp;nbsp;= "usuarioBD";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;$password = "passwordBD";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;$bd &amp;nbsp; &amp;nbsp; &amp;nbsp; = "datalogger";&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;// Crear conexión&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;$conn = new mysqli($servidor, $usuario, $password, $bd);&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;// Comprobar conexión&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;if ($conn-&gt;connect_error) {&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;&amp;nbsp; &amp;nbsp; die("Error de conexión: " . $conn-&gt;connect_error);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;}&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;// Comprobar que llegan los datos por GET&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;if (isset($_GET['temperatura']) &amp;&amp; isset($_GET['humedad'])) {&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;&amp;nbsp; &amp;nbsp; date_default_timezone_set('Europe/Madrid');&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;&amp;nbsp; &amp;nbsp; $fecha = date("Y-m-d H:i:s");&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;&amp;nbsp; &amp;nbsp; $temperatura = $_GET['temperatura'];&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;&amp;nbsp; &amp;nbsp; $humedad &amp;nbsp; &amp;nbsp; = $_GET['humedad'];&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;&amp;nbsp; &amp;nbsp; // Preparar la consulta (más seguro que usar INSERT directo)&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;&amp;nbsp; &amp;nbsp; $stmt = $conn-&gt;prepare(&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; "INSERT INTO registro1 (temperatura, humedad,fecha) VALUES (?,?,?)"&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;&amp;nbsp; &amp;nbsp; );&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;&amp;nbsp; &amp;nbsp; $stmt-&gt;bind_param("dd", $temperatura, $humedad,$fecha);&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;&amp;nbsp; &amp;nbsp; if ($stmt-&gt;execute()) {&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; echo "Datos insertados correctamente";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;&amp;nbsp; &amp;nbsp; } else {&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; echo "Error al insertar datos";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;&amp;nbsp; &amp;nbsp; }&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;&amp;nbsp; &amp;nbsp; $stmt-&gt;close();&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;} else {&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;&amp;nbsp; &amp;nbsp; echo "Faltan datos";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;}&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;$conn-&gt;close();&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;?&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;&lt;/span&gt;&lt;br&gt;&lt;/p&gt;&lt;p class="clearfix"&gt;&lt;/p&gt;&lt;/div&gt;
            &lt;/div&gt;&lt;/div&gt;&lt;/div&gt;</htmlView><jsonProperties>{"ideviceId":"20260125130842676MET","textInfoDurationInput":"","textInfoDurationTextInput":"Duración","textInfoParticipantsInput":"","textInfoParticipantsTextInput":"Agrupamiento","textTextarea":"&lt;h2&gt;REGISTRO Y ENVÍO DE DATOS &lt;/h2&gt;\n&lt;p&gt;PETICIONES GET Y POST&lt;/p&gt;\n&lt;p&gt;&lt;img src=\"{{context_path}}/20260125130842676MET/infraestructura2.gif\" width=\"650\" height=\"218\" alt=\"\" /&gt;&lt;/p&gt;\n&lt;p&gt;&lt;br /&gt;&lt;/p&gt;\n&lt;p&gt;Nuestro punto de partida un sistema de control sensorizado, el cual queremos registrar y tener acceso en tiempo real a los datos. Normalmente, los sistemas de control que se usan a nivel educativo tienen el potencial de poder ofrecernos la información en tiempo real a través de un pequeño servidor Web que se puede gestionar en la propia placa, pero no tienen la capacidad de gestionar un histórico de datos debido a la escasez de memoria de almacenamiento, por ello, esta posibilidad no la vamos a considerar.&lt;/p&gt;\n&lt;p&gt;Una vez que tenemos las variables con los datos que deseamos registrar, vamos a construir una URL para madar la información a nuestro servidor. Esa solicitud la vamos a hacer a través de un petición GET, es más fácil de enterder que la POST, y nos vale para la mayoría de los casos. Esta solicitud tiene la siguiente estructura: &lt;a href=\"http://miDominio/mandaDatos.php?var1=dato1&amp;var2=dato2\"&gt;http://miDominio/mandaDatos.php?var1=dato1&amp;var2=dato2&lt;/a&gt; &lt;/p&gt;\n&lt;p&gt;Se puede deducir que mandaDatos.php es un script que elaboraremos ad hoc, y que las variables var1,var2, ... son las variables con sus respectivos valores (numéricas o alfanumerícas). A esa URL se accederá co el bloque GET que montramos bajo estas líneas si trabajamos con Steamakersblocks.&lt;/p&gt;\n&lt;p&gt;&lt;img src=\"{{context_path}}/20260125130842676MET/BHTTPServer.png\" width=\"275\" height=\"86\" alt=\"\" /&gt;&lt;/p&gt;\n&lt;p&gt;Si trabajamos con el entorno IDE de arduino, el código a insertar sería  algo como lo que se muestra, una vez, claro esto, tenemos recopilados los datos y activada nuestra conexión WiFi.&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;#include &lt;httpclient.h&gt;&lt;/httpclient.h&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;    HTTPClient http;&lt;br /&gt;    WiFiClient client;&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;    String url = \"http://miDominio/mandaDatos.php?temperatura=\"+String(temp,2)+\"&amp;humedad=\"+String(humedad,1);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;    http.begin(client, url);&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;    int httpCode = http.GET();  // Realiza la petición&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;    http.end();&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;  }&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;}&lt;/span&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;&lt;/span&gt;&lt;br /&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;El script PHP para añadir los datos a nuestra base de datos será el siguiente.&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;&lt;?php&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;// Datos de conexión a la base de datos&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;$servidor = \"localhost\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;$usuario  = \"usuarioBD\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;$password = \"passwordBD\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;$bd       = \"datalogger\";&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;// Crear conexión&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;$conn = new mysqli($servidor, $usuario, $password, $bd);&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;// Comprobar conexión&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;if ($conn-&gt;connect_error) {&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;    die(\"Error de conexión: \" . $conn-&gt;connect_error);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;}&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;// Comprobar que llegan los datos por GET&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;if (isset($_GET['temperatura']) &amp;&amp; isset($_GET['humedad'])) {&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;    date_default_timezone_set('Europe/Madrid');&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;    $fecha = date(\"Y-m-d H:i:s\");&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;    $temperatura = $_GET['temperatura'];&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;    $humedad     = $_GET['humedad'];&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;    // Preparar la consulta (más seguro que usar INSERT directo)&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;    $stmt = $conn-&gt;prepare(&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;        \"INSERT INTO registro1 (temperatura, humedad,fecha) VALUES (?,?,?)\"&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;    );&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;    $stmt-&gt;bind_param(\"dd\", $temperatura, $humedad,$fecha);&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;    if ($stmt-&gt;execute()) {&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;        echo \"Datos insertados correctamente\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;    } else {&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;        echo \"Error al insertar datos\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;    }&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;    $stmt-&gt;close();&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;} else {&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;    echo \"Faltan datos\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;}&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;$conn-&gt;close();&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;?&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;&lt;/span&gt;&lt;br /&gt;&lt;/p&gt;","textFeedbackInput":"Mostrar retroalimentación","textFeedbackTextarea":""}</jsonProperties><odeComponentsOrder>1</odeComponentsOrder><odeComponentsProperties><odeComponentsProperty><key>visibility</key><value>true</value></odeComponentsProperty><odeComponentsProperty><key>teacherOnly</key><value>false</value></odeComponentsProperty><odeComponentsProperty><key>identifier</key><value/></odeComponentsProperty><odeComponentsProperty><key>cssClass</key><value/></odeComponentsProperty></odeComponentsProperties></odeComponent></odeComponents></odePagStructure></odePagStructures></odeNavStructure><odeNavStructure><odePageId>20260206013613QZVSJA</odePageId><odeParentPageId/><pageName>Estructuras almacenamiento de datos</pageName><odeNavStructureOrder>3</odeNavStructureOrder><odeNavStructureProperties><odeNavStructureProperty><key>titleNode</key><value>Estructuras almacenamiento de datos</value></odeNavStructureProperty><odeNavStructureProperty><key>hidePageTitle</key><value>false</value></odeNavStructureProperty><odeNavStructureProperty><key>titleHtml</key><value/></odeNavStructureProperty><odeNavStructureProperty><key>editableInPage</key><value>false</value></odeNavStructureProperty><odeNavStructureProperty><key>titlePage</key><value>Estructuras almacenamiento de datos</value></odeNavStructureProperty><odeNavStructureProperty><key>visibility</key><value>true</value></odeNavStructureProperty><odeNavStructureProperty><key>highlight</key><value>false</value></odeNavStructureProperty><odeNavStructureProperty><key>description</key><value/></odeNavStructureProperty></odeNavStructureProperties><odePagStructures><odePagStructure><odePageId>20260206013613QZVSJA</odePageId><odeBlockId>20260206013613BHCQQN</odeBlockId><blockName>Almacenamiento de datos</blockName><iconName/><odePagStructureOrder>1</odePagStructureOrder><odePagStructureProperties><odePagStructureProperty><key>visibility</key><value>true</value></odePagStructureProperty><odePagStructureProperty><key>teacherOnly</key><value>false</value></odePagStructureProperty><odePagStructureProperty><key>allowToggle</key><value>true</value></odePagStructureProperty><odePagStructureProperty><key>minimized</key><value>false</value></odePagStructureProperty><odePagStructureProperty><key>identifier</key><value/></odePagStructureProperty><odePagStructureProperty><key>cssClass</key><value/></odePagStructureProperty></odePagStructureProperties><odeComponents><odeComponent><odePageId>20260206013613QZVSJA</odePageId><odeBlockId>20260206013613BHCQQN</odeBlockId><odeIdeviceId>20260125191741454RF5</odeIdeviceId><odeIdeviceTypeName>text</odeIdeviceTypeName><htmlView>&lt;div class="exe-text-template"&gt;&lt;div class="textIdeviceContent"&gt;
            &lt;div class="exe-text-activity"&gt;
                &lt;div&gt;&lt;p&gt;&lt;img src="{{context_path}}/20260125191741454RF5/base-de-datos-min-e1523470739502.jpg" width="272" height="141" alt=""&gt;&lt;/p&gt;
&lt;p&gt;En este apartado, muy brevemente, indicamos los paso para crear nuestra estructura de datos. Suponemos que disponemos de un alojamiento web con PHP y MySQL (LAMP). Puede estar dentro de nuestro propio centro educativo sin acceso real desde fuera de la Intranet educativa. La red Andared_IoT podrá acceder a nuestro servidor usando la IP del servidor.&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;&lt;p class="clearfix"&gt;&lt;/p&gt;&lt;/div&gt;
            &lt;/div&gt;&lt;/div&gt;&lt;/div&gt;</htmlView><jsonProperties>{"ideviceId":"20260125191741454RF5","textInfoDurationInput":"","textInfoDurationTextInput":"Duración","textInfoParticipantsInput":"","textInfoParticipantsTextInput":"Agrupamiento","textTextarea":"&lt;p&gt;&lt;img src=\"{{context_path}}/20260125191741454RF5/base-de-datos-min-e1523470739502.jpg\" width=\"272\" height=\"141\" alt=\"\" /&gt;&lt;/p&gt;\n&lt;p&gt;En este apartado, muy brevemente, indicamos los paso para crear nuestra estructura de datos. Suponemos que disponemos de un alojamiento web con PHP y MySQL (LAMP). Puede estar dentro de nuestro propio centro educativo sin acceso real desde fuera de la Intranet educativa. La red Andared_IoT podrá acceder a nuestro servidor usando la IP del servidor.&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;","textFeedbackInput":"Mostrar retroalimentación","textFeedbackTextarea":""}</jsonProperties><odeComponentsOrder>1</odeComponentsOrder><odeComponentsProperties><odeComponentsProperty><key>visibility</key><value>true</value></odeComponentsProperty><odeComponentsProperty><key>teacherOnly</key><value>false</value></odeComponentsProperty><odeComponentsProperty><key>identifier</key><value/></odeComponentsProperty><odeComponentsProperty><key>cssClass</key><value/></odeComponentsProperty></odeComponentsProperties></odeComponent></odeComponents></odePagStructure></odePagStructures></odeNavStructure><odeNavStructure><odePageId>20260206013613EGLEMT</odePageId><odeParentPageId/><pageName>Graficado de los datos PHP</pageName><odeNavStructureOrder>4</odeNavStructureOrder><odeNavStructureProperties><odeNavStructureProperty><key>titleNode</key><value>Graficado de los datos PHP</value></odeNavStructureProperty><odeNavStructureProperty><key>hidePageTitle</key><value>false</value></odeNavStructureProperty><odeNavStructureProperty><key>titleHtml</key><value/></odeNavStructureProperty><odeNavStructureProperty><key>editableInPage</key><value>false</value></odeNavStructureProperty><odeNavStructureProperty><key>titlePage</key><value>Graficado de los datos PHP</value></odeNavStructureProperty><odeNavStructureProperty><key>visibility</key><value>true</value></odeNavStructureProperty><odeNavStructureProperty><key>highlight</key><value>false</value></odeNavStructureProperty><odeNavStructureProperty><key>description</key><value/></odeNavStructureProperty></odeNavStructureProperties><odePagStructures><odePagStructure><odePageId>20260206013613EGLEMT</odePageId><odeBlockId>20260206013613OOLJAC</odeBlockId><blockName>Graficado PHP</blockName><iconName/><odePagStructureOrder>1</odePagStructureOrder><odePagStructureProperties><odePagStructureProperty><key>visibility</key><value>true</value></odePagStructureProperty><odePagStructureProperty><key>teacherOnly</key><value>false</value></odePagStructureProperty><odePagStructureProperty><key>allowToggle</key><value>true</value></odePagStructureProperty><odePagStructureProperty><key>minimized</key><value>false</value></odePagStructureProperty><odePagStructureProperty><key>identifier</key><value/></odePagStructureProperty><odePagStructureProperty><key>cssClass</key><value/></odePagStructureProperty></odePagStructureProperties><odeComponents><odeComponent><odePageId>20260206013613EGLEMT</odePageId><odeBlockId>20260206013613OOLJAC</odeBlockId><odeIdeviceId>20260126143233349B7P</odeIdeviceId><odeIdeviceTypeName>text</odeIdeviceTypeName><htmlView>&lt;div class="exe-text-template"&gt;&lt;div class="textIdeviceContent"&gt;
            &lt;div class="exe-text-activity"&gt;
                &lt;div&gt;&lt;p&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;El script a alojar en el servidor es el siguiente.&amp;nbsp;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;Le pasaremos en chart el nombre de la tabla a graficar. Cambiar hora y dato por el nombre de los atributos a representar. El atributo hora debe ser del tipo datetime.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&lt;?php&lt;br&gt;$USER='tu_user';&lt;br&gt;$PASS='tu_pass';&lt;br&gt;$base='datalogger';&lt;br&gt;$link=mysqli_connect("localhost",$USER,$PASS);&lt;br&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$chart=$_GET['chart'];&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;if ($chart=='') $chart='temperatura';&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;function imagelinedotted ($im, $x1, $y1, $x2, $y2, $dist, $col) {&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; $transp = imagecolortransparent ($im);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; $style = array ($col);&lt;/span&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; for ($i=0; $i&lt;$dist; $i++) {&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; array_push($style, $transp); &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;// Generate style array - loop needed for customisable distance between the dots&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; }&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; imagesetstyle ($im, $style);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; return (integer) imageline ($im, $x1, $y1, $x2, $y2, IMG_COLOR_STYLED);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; imagesetstyle ($im, array($col)); &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;// Reset style - just in case...&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;}&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;mysqli_select_db($link,$base) or die("Could not select database");&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$grid=1;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$im = imagecreatetruecolor(500,450);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$white = imagecolorallocate($im,120,165,255);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$blanco = imagecolorallocate($im,255,255,255);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$amarillo= imagecolorallocate($im,255,255,0);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$rojo= imagecolorallocate($im,255,50,50);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$fondo= imagecolorallocate($im,236,240,246);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;imagefill($im,0,0,$white);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$query2 = "SELECT count(*) , min(dato), max(dato), avg(dato),min(hora),max(hora) from $chart";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$result2 = mysqli_query($link,$query2) or die("Query failed $query2");&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$line2 = mysqli_fetch_row($result2);&amp;nbsp;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$media=$line2[3];&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$rec=$line2[0];&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$mina=$line2[1]-$line2[1]*0.1;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$maxa=$line2[2]+$line2[2]*0.1;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$min=$line2[1];&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$max=$line2[2];&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$minx=substr($line2[4],11,2)+1;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$maxx=substr($line2[5],11,2)+1;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$ha=0;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;if ($minx &gt; $maxx) {$ha=1;$maxx+=24;}&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$x0=40;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$y0=30;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$alto=300;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$ancho=420;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;imagerectangle ($im,$x0,$y0,$ancho+$x0,$alto+$y0,$fondo);&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$query2 = "SELECT hora,dato from $chart order by id";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$result2 = mysqli_query($link,$query2) or die("Query failed $query2");&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$x=50;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$incx=$ancho/($maxx-$minx);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;if ($maxa-$mina==0)&amp;nbsp;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;$incy=1;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;else&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;$incy=$alto/($maxa-$mina);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$ch=ceil($mina);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$inl=ceil (($maxa-$mina) / 8);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;/*if ($maxa-$mina &lt;= 10 ) $inl=1;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;if (($maxa-$mina &gt;10) &amp;&amp; &amp;nbsp;($maxa-$mina) &lt;= 30) $inl=2;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;if (($maxa-$mina) &gt;30 &amp;&amp; ($maxa-$mina)&lt;100) $inl=20;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;if (($maxa-$mina) &gt;100 &amp;&amp; ($maxa-$mina)&lt;100) $inl=50;*/&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;while ($ch&lt;$maxa) {&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; $ny=$alto+$y0-($ch-$mina)*$incy;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; imagestring ($im,4,15,$ny-8,$ch,$blanco);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; imageline($im,35,$ny,40,$ny,$blanco);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; if ($grid) imagelinedotted($im,42,$ny,40+$ancho-3,$ny,5,3);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; $ch=$ch+$inl;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$c=0;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$ch=$minx+1;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;while ($ch&lt;=$maxx+1) {&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;$x1=$x0+$incx*($ch-($minx+1));&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; if ($x1&gt;39) {&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; if ($c%4==0) {&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;imageline($im,$x1,$y0+$alto,$x1,$y0+$alto+15,$blanco);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;$cad=sprintf ("%02d:00",$ch);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;imagestring ($im,4,$x1-20,$y0+$alto+15,$cad,$blanco);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;if ($grid ) imagelinedotted($im,$x1,$y0+$alto-2,$x1,$y0+2,5,3);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; }&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; else&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;imageline($im,$x1,$y0+$alto,$x1,$y0+$alto+10,$blanco);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; }&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;$ch+=0.25;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; $c++;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;if ($chart=='temperatura')&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; imagestring($im,5,$ancho/2,380,"Temperatura(\7C)",$blanco);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;if ($chart=='humedad')&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; imagestring($im,5,$ancho/2,380,"Humedad relativa",$blanco);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;if ($chart=='no2')&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; imagestring($im,5,$ancho/2,380,"Dioxido Nitrogeno (ug/m3)",$blanco);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;if ($chart=='co')&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; imagestring($im,5,$ancho/2,380,"Monoxido Carbono (ug/m3)",$blanco);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;if ($chart=='particulas')&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; imagestring($im,5,$ancho/2,380,"Particulas (ug/m3)",$blanco);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;imagestring($im,4,40,375,"Min: $min",$blanco);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;imagestring($im,4,40,390,"Max: $max",$blanco);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$med=sprintf("%.2f",$media);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;imagestring($im,4,40,405,"Media: $med",$blanco);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$c=0;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;while ($line2 = mysqli_fetch_row($result2)){&amp;nbsp;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; $hora=$line2[0];&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; $dato=$line2[1];&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; $minu=substr($hora,14,2)*100/60;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; $hor=substr($hora,11,2);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; $hora=substr($hora,11,5);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; if (($ha==1) &amp;&amp; ($hor&lt;$minx-1)) $hor+=24;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; if ($hor&gt;=$minx) {&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; $x1=$x0+$incx*(($hor-$minx)+$minu/100);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; $y1=$y0+$alto-($dato-$mina)*$incy;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; if ($c!=0) {&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; for ($a=0;$a&lt;=3;$a++)&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; {&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; $color=imagecolorallocate($im,100+($a*30),100+($a*30),0);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; imageline($im,$x2,$y2+$a,$x1,$y1+$a,$color);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; imagefilledellipse($im, $x1, $y1, 6, 6, $rojo);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; }&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; else&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; {&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; $horaini=$hora;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; imagefilledellipse($im, $x1, $y1, 6, 6, $rojo);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; }&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; //imageline($im,$x1,$y0+$alto,$x1,$y0+$alto+10,$blanco);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; $y2=$y1;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; $x2=$x1; &amp;nbsp; &amp;nbsp;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; $c++;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; $horalast=$hora;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; }&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; //$azul=imagecolorallocate($im,20,20,255);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; //$alto=$base-$factor*$media;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; //imageline($im,30,$alto,230,$alto,$azul);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; $rojo=imagecolorallocate($im,255,20,20);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; $pos=$y0+$alto-($media-$mina)*$incy;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; imageline($im,$x0,$pos,$x0+$ancho,$pos,$rojo);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$hora=substr($horaini,0,2)+1;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$hora2=substr($horalast,0,2)+1;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;if ($hora &gt; 23 ) $hora = $hora-24;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;if ($hora2 &gt; 23 ) $hora2 = $hora2-24;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$horaini=sprintf("%0d%s",$hora,substr($horaini,2,100));&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$horalast=sprintf("%0d%s",$hora2,substr($horalast,2,100));&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$fecha=date("d/m/Y")." desde ".$horaini." hasta las ".$horalast;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;imagestring($im,4,40,420,"Fecha: $fecha",$blanco);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;header("Content-type: image/gif");&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;imagegif($im);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;imagedestroy($im);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;?&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class="clearfix"&gt;&lt;/p&gt;&lt;/div&gt;
            &lt;/div&gt;&lt;/div&gt;&lt;/div&gt;</htmlView><jsonProperties>{"ideviceId":"20260126143233349B7P","textInfoDurationInput":"","textInfoDurationTextInput":"Duration","textInfoParticipantsInput":"","textInfoParticipantsTextInput":"Grouping","textTextarea":"&lt;p&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;El script a alojar en el servidor es el siguiente. &lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;Le pasaremos en chart el nombre de la tabla a graficar. Cambiar hora y dato por el nombre de los atributos a representar. El atributo hora debe ser del tipo datetime.&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;&lt;?php&lt;br /&gt;$USER='tu_user';&lt;br /&gt;$PASS='tu_pass';&lt;br /&gt;$base='datalogger';&lt;br /&gt;$link=mysqli_connect(\"localhost\",$USER,$PASS);&lt;br /&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$chart=$_GET['chart'];&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;if ($chart=='') $chart='temperatura';&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;function imagelinedotted ($im, $x1, $y1, $x2, $y2, $dist, $col) {&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    $transp = imagecolortransparent ($im);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    $style = array ($col);&lt;/span&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;   &lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    for ($i=0; $i&lt;$dist; $i++) {&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;        array_push($style, $transp);        // Generate style array - loop needed for customisable distance between the dots&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    }&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;   &lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    imagesetstyle ($im, $style);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    return (integer) imageline ($im, $x1, $y1, $x2, $y2, IMG_COLOR_STYLED);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    imagesetstyle ($im, array($col));        // Reset style - just in case...&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;}&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;mysqli_select_db($link,$base) or die(\"Could not select database\");&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$grid=1;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$im = imagecreatetruecolor(500,450);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$white = imagecolorallocate($im,120,165,255);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$blanco = imagecolorallocate($im,255,255,255);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$amarillo= imagecolorallocate($im,255,255,0);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$rojo= imagecolorallocate($im,255,50,50);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$fondo= imagecolorallocate($im,236,240,246);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;imagefill($im,0,0,$white);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$query2 = \"SELECT count(*) , min(dato), max(dato), avg(dato),min(hora),max(hora) from $chart\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$result2 = mysqli_query($link,$query2) or die(\"Query failed $query2\");&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$line2 = mysqli_fetch_row($result2); &lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$media=$line2[3];&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$rec=$line2[0];&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$mina=$line2[1]-$line2[1]*0.1;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$maxa=$line2[2]+$line2[2]*0.1;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$min=$line2[1];&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$max=$line2[2];&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$minx=substr($line2[4],11,2)+1;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$maxx=substr($line2[5],11,2)+1;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$ha=0;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;if ($minx &gt; $maxx) {$ha=1;$maxx+=24;}&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$x0=40;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$y0=30;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$alto=300;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$ancho=420;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;imagerectangle ($im,$x0,$y0,$ancho+$x0,$alto+$y0,$fondo);&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$query2 = \"SELECT hora,dato from $chart order by id\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$result2 = mysqli_query($link,$query2) or die(\"Query failed $query2\");&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$x=50;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$incx=$ancho/($maxx-$minx);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;if ($maxa-$mina==0) &lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; $incy=1;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;else&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; $incy=$alto/($maxa-$mina);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$ch=ceil($mina);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$inl=ceil (($maxa-$mina) / 8);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;/*if ($maxa-$mina &lt;= 10 ) $inl=1;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;if (($maxa-$mina &gt;10) &amp;&amp;  ($maxa-$mina) &lt;= 30) $inl=2;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;if (($maxa-$mina) &gt;30 &amp;&amp; ($maxa-$mina)&lt;100) $inl=20;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;if (($maxa-$mina) &gt;100 &amp;&amp; ($maxa-$mina)&lt;100) $inl=50;*/&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;while ($ch&lt;$maxa) {&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    $ny=$alto+$y0-($ch-$mina)*$incy;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    imagestring ($im,4,15,$ny-8,$ch,$blanco);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    imageline($im,35,$ny,40,$ny,$blanco);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    if ($grid) imagelinedotted($im,42,$ny,40+$ancho-3,$ny,5,3);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    $ch=$ch+$inl;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$c=0;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$ch=$minx+1;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;while ($ch&lt;=$maxx+1) {&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;       $x1=$x0+$incx*($ch-($minx+1));&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    if ($x1&gt;39) {&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    if ($c%4==0) {&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;       imageline($im,$x1,$y0+$alto,$x1,$y0+$alto+15,$blanco);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;       $cad=sprintf (\"%02d:00\",$ch);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;       imagestring ($im,4,$x1-20,$y0+$alto+15,$cad,$blanco);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;       if ($grid ) imagelinedotted($im,$x1,$y0+$alto-2,$x1,$y0+2,5,3);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    }&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    else&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;       imageline($im,$x1,$y0+$alto,$x1,$y0+$alto+10,$blanco);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    }&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;     $ch+=0.25;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    $c++;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;if ($chart=='temperatura')&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    imagestring($im,5,$ancho/2,380,\"Temperatura(\\7C)\",$blanco);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;if ($chart=='humedad')&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    imagestring($im,5,$ancho/2,380,\"Humedad relativa\",$blanco);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;if ($chart=='no2')&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    imagestring($im,5,$ancho/2,380,\"Dioxido Nitrogeno (ug/m3)\",$blanco);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;if ($chart=='co')&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    imagestring($im,5,$ancho/2,380,\"Monoxido Carbono (ug/m3)\",$blanco);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;if ($chart=='particulas')&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    imagestring($im,5,$ancho/2,380,\"Particulas (ug/m3)\",$blanco);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;imagestring($im,4,40,375,\"Min: $min\",$blanco);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;imagestring($im,4,40,390,\"Max: $max\",$blanco);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$med=sprintf(\"%.2f\",$media);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;imagestring($im,4,40,405,\"Media: $med\",$blanco);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$c=0;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;while ($line2 = mysqli_fetch_row($result2)){ &lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    $hora=$line2[0];&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    $dato=$line2[1];&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    $minu=substr($hora,14,2)*100/60;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    $hor=substr($hora,11,2);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    $hora=substr($hora,11,5);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    if (($ha==1) &amp;&amp; ($hor&lt;$minx-1)) $hor+=24;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    if ($hor&gt;=$minx) {&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    $x1=$x0+$incx*(($hor-$minx)+$minu/100);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    $y1=$y0+$alto-($dato-$mina)*$incy;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    if ($c!=0) {&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;        for ($a=0;$a&lt;=3;$a++)&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;        {&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;            $color=imagecolorallocate($im,100+($a*30),100+($a*30),0);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;            imageline($im,$x2,$y2+$a,$x1,$y1+$a,$color);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;        }&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;        imagefilledellipse($im, $x1, $y1, 6, 6, $rojo);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    }&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    else&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    {&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;        $horaini=$hora;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;        imagefilledellipse($im, $x1, $y1, 6, 6, $rojo);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    }&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    //imageline($im,$x1,$y0+$alto,$x1,$y0+$alto+10,$blanco);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    $y2=$y1;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;        $x2=$x1;    &lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    $c++;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    $horalast=$hora;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    }&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    //$azul=imagecolorallocate($im,20,20,255);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    //$alto=$base-$factor*$media;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    //imageline($im,30,$alto,230,$alto,$azul);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    $rojo=imagecolorallocate($im,255,20,20);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    $pos=$y0+$alto-($media-$mina)*$incy;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    imageline($im,$x0,$pos,$x0+$ancho,$pos,$rojo);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$hora=substr($horaini,0,2)+1;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$hora2=substr($horalast,0,2)+1;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;if ($hora &gt; 23 ) $hora = $hora-24;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;if ($hora2 &gt; 23 ) $hora2 = $hora2-24;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$horaini=sprintf(\"%0d%s\",$hora,substr($horaini,2,100));&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$horalast=sprintf(\"%0d%s\",$hora2,substr($horalast,2,100));&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$fecha=date(\"d/m/Y\").\" desde \".$horaini.\" hasta las \".$horalast;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;imagestring($im,4,40,420,\"Fecha: $fecha\",$blanco);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;header(\"Content-type: image/gif\");&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;imagegif($im);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;imagedestroy($im);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;?&gt;&lt;/span&gt;&lt;/p&gt;","textFeedbackInput":"Show Feedback","textFeedbackTextarea":""}</jsonProperties><odeComponentsOrder>1</odeComponentsOrder><odeComponentsProperties><odeComponentsProperty><key>visibility</key><value>true</value></odeComponentsProperty><odeComponentsProperty><key>teacherOnly</key><value>false</value></odeComponentsProperty><odeComponentsProperty><key>identifier</key><value/></odeComponentsProperty><odeComponentsProperty><key>cssClass</key><value/></odeComponentsProperty></odeComponentsProperties></odeComponent></odeComponents></odePagStructure></odePagStructures></odeNavStructure><odeNavStructure><odePageId>20260206013613OUDZBE</odePageId><odeParentPageId/><pageName>Graficado en Google Sheets</pageName><odeNavStructureOrder>5</odeNavStructureOrder><odeNavStructureProperties><odeNavStructureProperty><key>titleNode</key><value/></odeNavStructureProperty><odeNavStructureProperty><key>hidePageTitle</key><value>false</value></odeNavStructureProperty><odeNavStructureProperty><key>titleHtml</key><value/></odeNavStructureProperty><odeNavStructureProperty><key>editableInPage</key><value>false</value></odeNavStructureProperty><odeNavStructureProperty><key>titlePage</key><value>Graficado en Google Sheets</value></odeNavStructureProperty><odeNavStructureProperty><key>visibility</key><value>true</value></odeNavStructureProperty><odeNavStructureProperty><key>highlight</key><value>false</value></odeNavStructureProperty><odeNavStructureProperty><key>description</key><value/></odeNavStructureProperty></odeNavStructureProperties><odePagStructures><odePagStructure><odePageId>20260206013613OUDZBE</odePageId><odeBlockId>20260206013613WHLKLX</odeBlockId><blockName>Graficado en google sheets</blockName><iconName/><odePagStructureOrder>1</odePagStructureOrder><odePagStructureProperties><odePagStructureProperty><key>visibility</key><value>true</value></odePagStructureProperty><odePagStructureProperty><key>teacherOnly</key><value>false</value></odePagStructureProperty><odePagStructureProperty><key>allowToggle</key><value>true</value></odePagStructureProperty><odePagStructureProperty><key>minimized</key><value>false</value></odePagStructureProperty><odePagStructureProperty><key>identifier</key><value/></odePagStructureProperty><odePagStructureProperty><key>cssClass</key><value/></odePagStructureProperty></odePagStructureProperties><odeComponents><odeComponent><odePageId>20260206013613OUDZBE</odePageId><odeBlockId>20260206013613WHLKLX</odeBlockId><odeIdeviceId>20260128140532716AGF</odeIdeviceId><odeIdeviceTypeName>text</odeIdeviceTypeName><htmlView>&lt;div class="exe-text-template"&gt;&lt;div class="textIdeviceContent"&gt;
            &lt;div class="exe-text-activity"&gt;
                &lt;div&gt;&lt;p&gt;Para graficar en google sheets necesitamos un app script que se encargue de añadir los datos que nos llegan a través de la petición get de la placa y procederemos a realizar un gráfica empleando los rangos [columna][fila]:[columa], de este modo la la hoja entiende que debe graficar toda la columna.&lt;/p&gt;
&lt;p&gt;Muestro seguidamente un app script orientativo.&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;var lat=0.0;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;var lon=0.0;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;function modificarKML() {&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; var fileId = 'skfsldakgfh sadfhsdadsfsad'; &amp;nbsp;// Reemplázalo con tu ID de archivo KML&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; // ID del archivo KML en Google Drive&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; var file = DriveApp.getFileById(fileId);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; // Leer el contenido del archivo KML&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; var content = file.getBlob().getDataAsString();&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; // Si deseas agregar una nueva coordenada o modificar alguna otra parte, puedes hacerlo aquí&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; // Ejemplo: agregar una nueva coordenada en &lt;coordinates&gt;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; newContent = content.replace('&lt;coordinates&gt;', '&lt;coordinates&gt;\n'+String(lon)+','+String(lat));&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; // Escribir el nuevo contenido en el archivo&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; file.setContent(newContent);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;}&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;function verificarSignal() {&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; const LIMITE_SEGUNDOS = 20;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; const ss = SpreadsheetApp.getActive();&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; const hojaDatos = ss.getSheetByName("Cansat");&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; const hojaDash = ss.getSheetByName("Dash");&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; // Última fila con datos&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; const lastRow = hojaDatos.getLastRow();&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; if (lastRow &lt; 32) return;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; // Última marca de tiempo (columna A)&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; const ultimaFecha = hojaDatos.getRange(lastRow, 18).getValue();&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; const ahora = new Date();&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; const diffSegundos = (ahora - ultimaFecha) / 1000;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; hojaDatos.getRange("AA32").setValue(diffSegundos);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; if (diffSegundos &gt; LIMITE_SEGUNDOS) {&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; mostrarAlarma(hojaDatos);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; } else {&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; ocultarAlarma(hojaDatos);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; }&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;}&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;function mostrarAlarma(hoja) {&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; const rango = hoja.getRange("AC8:AG9");&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; rango&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; .setValue("🚨 SIGNAL LOST 🚨")&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; .setBackground("#FF0000")&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; .setFontColor("#FFFFFF")&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; .setFontSize(20)&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; .setHorizontalAlignment("center")&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; .setVerticalAlignment("middle");&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;}&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;function ocultarAlarma(hoja) {&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; const rango = hoja.getRange("AC8:AG9");&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; rango&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; .setValue(" SYSTEM ONLINE ")&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; .setBackground("#00AA40")&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; .setFontColor("#FFFFFF")&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; .setFontSize(20)&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; .setHorizontalAlignment("center")&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; .setVerticalAlignment("middle");&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;}&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;function doGet(e) {&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp;var spd = SpreadsheetApp.openById("hjlkfhdlfkjshdfskjfhdfsa"); //SpreadsheetApp.getActiveSpreadsheet(); &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp;var fileId = '1yH-3X5qkfaVsOJ4zCF7lviHKlA5DG2m5'; &amp;nbsp;// Reemplázalo con tu ID de archivo KML&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp;var sheet4 = spd.getSheets()[1];&amp;nbsp;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp;// configuration&lt;/span&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; const data = e.parameter.data;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; const ws = sheet4;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; //--------------------------------------------&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; // RESET KML&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; //--------------------------------------------&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; if (ws.getRange("X2").getValue().toUpperCase() === "RESET") {&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; const file = DriveApp.getFileById(fileId);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; const content = file.getBlob().getDataAsString();&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; const newContent = content.replace(/&lt;coordinates&gt;[\s\S]*?&lt;\/coordinates&gt;/g,&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;'&lt;coordinates&gt;\n&lt;/coordinates&gt;');&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; file.setContent(newContent);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; ws.getRange("X2").setValue("DONE");&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; }&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; //--------------------------------------------&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; // Registro pausado&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; //--------------------------------------------&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; if (ws.getRange("AE1").getValue() !== "REGISTRANDO")&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; return ContentService.createTextOutput("Registro de datos pausado.");&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; //--------------------------------------------&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; // Añadir nueva fila&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; //--------------------------------------------&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; data2 = data.replace(/\./g, ",");&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; ws.appendRow([data2]);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; const pos = ws.getLastRow();&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; ws.getRange(pos, 2).setFormula('=SPLIT(A' + pos + ';";")');&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; ws.getRange("AH6").setValue(ws.getRange("AG6").getValue());&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; ws.getRange(pos, 20).setFormulaR1C1(&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; '=2*6371*ASIN(SQRT(' +&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; 'SIN((RADIANS(RC[-10])-RADIANS(R[-1]C[-10]))/2)^2+' +&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; 'COS(RADIANS(RC[-10]))*COS(RADIANS(R[-1]C[-10]))*' +&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; 'SIN((RADIANS(RC[-7])-RADIANS(R[-1]C[-7]))/2)^2' +&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; '))'&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; ws.getRange(pos,19).setFormulaR1C1('=RC[1]/(RC[-1]-R[-1]C[-1])/86400');&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; //--------------------------------------------&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; const ahora = new Date();&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; ws.getRange(pos, 18).setValue(ahora).setNumberFormat("hh:mm:ss");&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; //--------------------------------------------&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; // Escritura en archivo KML (solo si está ON)&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; //--------------------------------------------&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; if (ws.getRange("W2").getValue().toUpperCase() === "ON" ) {&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; const lat = ws.getRange(pos, 10).getValue();&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; const lon = ws.getRange(pos, 13).getValue();&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; const file2 = DriveApp.getFileById(fileId);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; const content2 = file2.getBlob().getDataAsString();&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; const newContent2 = content2.replace('&lt;coordinates&gt;', `&lt;coordinates&gt;\n${lon},${lat}`);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; file2.setContent(newContent2);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; }&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; //--------------------------------------------&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; // Actualiza contador&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; //--------------------------------------------&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; ws.getRange("AG1").setValue(pos - 31);&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; const url = "http://fabarca.hopto.org:8000/estado";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; const celda = ws.getRange("AC2");&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; try {&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; const respuesta = UrlFetchApp.fetch(url, {&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; muteHttpExceptions: true,&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; followRedirects: true,&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; timeout: 2000&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; });&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; const datos = JSON.parse(respuesta.getContentText());&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; const transmitiendo = datos.transmitiendo === true;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; // Celda estado transmisión&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; const celdaEstado = ws.getRange("AC2");&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; celdaEstado.setValue(transmitiendo);&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; if (transmitiendo) {&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; celdaEstado.setBackground("#00ff00"); // verde&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; } else {&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; celdaEstado.setBackground("#ff0000"); // rojo&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; }&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; // Celda estado servidor&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; const celdaServidor = ws.getRange("AC7");&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; celdaServidor.setBackground("#00ff00"); // verde&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; celdaServidor.setValue("Servidor OK");&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;} catch (error) {&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; const celdaServidor = ws.getRange("AC7");&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; celdaServidor.setBackground("#ff0000"); // rojo&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; celdaServidor.setValue("Servidor Flask no responde");&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; celdaEstado.setBackground("#ff0000"); // rojo&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;}&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;}&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;&lt;/span&gt;&lt;/p&gt;&lt;p class="clearfix"&gt;&lt;/p&gt;&lt;/div&gt;
            &lt;/div&gt;&lt;/div&gt;&lt;/div&gt;</htmlView><jsonProperties>{"ideviceId":"20260128140532716AGF","textInfoDurationInput":"","textInfoDurationTextInput":"Duration","textInfoParticipantsInput":"","textInfoParticipantsTextInput":"Grouping","textTextarea":"&lt;p&gt;Para graficar en google sheets necesitamos un app script que se encargue de añadir los datos que nos llegan a través de la petición get de la placa y procederemos a realizar un gráfica empleando los rangos [columna][fila]:[columa], de este modo la la hoja entiende que debe graficar toda la columna.&lt;/p&gt;\n&lt;p&gt;Muestro seguidamente un app script orientativo.&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;var lat=0.0;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;var lon=0.0;&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;function modificarKML() {&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  var fileId = 'skfsldakgfh sadfhsdadsfsad';  // Reemplázalo con tu ID de archivo KML&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  // ID del archivo KML en Google Drive&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  var file = DriveApp.getFileById(fileId);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  // Leer el contenido del archivo KML&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  var content = file.getBlob().getDataAsString();&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  // Si deseas agregar una nueva coordenada o modificar alguna otra parte, puedes hacerlo aquí&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  // Ejemplo: agregar una nueva coordenada en &lt;coordinates&gt;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  newContent = content.replace('&lt;coordinates&gt;', '&lt;coordinates&gt;\\n'+String(lon)+','+String(lat));&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  // Escribir el nuevo contenido en el archivo&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  file.setContent(newContent);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;}&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;function verificarSignal() {&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  const LIMITE_SEGUNDOS = 20;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  const ss = SpreadsheetApp.getActive();&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  const hojaDatos = ss.getSheetByName(\"Cansat\");&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  const hojaDash = ss.getSheetByName(\"Dash\");&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  // Última fila con datos&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  const lastRow = hojaDatos.getLastRow();&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  if (lastRow &lt; 32) return;&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  // Última marca de tiempo (columna A)&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  &lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  const ultimaFecha = hojaDatos.getRange(lastRow, 18).getValue();&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  const ahora = new Date();&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  const diffSegundos = (ahora - ultimaFecha) / 1000;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  hojaDatos.getRange(\"AA32\").setValue(diffSegundos);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  if (diffSegundos &gt; LIMITE_SEGUNDOS) {&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    mostrarAlarma(hojaDatos);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  } else {&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    ocultarAlarma(hojaDatos);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  }&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;}&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;function mostrarAlarma(hoja) {&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  const rango = hoja.getRange(\"AC8:AG9\");&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  rango&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    .setValue(\"🚨 SIGNAL LOST 🚨\")&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    .setBackground(\"#FF0000\")&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    .setFontColor(\"#FFFFFF\")&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    .setFontSize(20)&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    .setHorizontalAlignment(\"center\")&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    .setVerticalAlignment(\"middle\");&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;}&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;function ocultarAlarma(hoja) {&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  const rango = hoja.getRange(\"AC8:AG9\");&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  rango&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    .setValue(\" SYSTEM ONLINE \")&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    .setBackground(\"#00AA40\")&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    .setFontColor(\"#FFFFFF\")&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    .setFontSize(20)&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    .setHorizontalAlignment(\"center\")&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    .setVerticalAlignment(\"middle\");&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;}&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;function doGet(e) {&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;   var spd = SpreadsheetApp.openById(\"hjlkfhdlfkjshdfskjfhdfsa\"); //SpreadsheetApp.getActiveSpreadsheet();            &lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;   var fileId = '1yH-3X5qkfaVsOJ4zCF7lviHKlA5DG2m5';  // Reemplázalo con tu ID de archivo KML&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;   var sheet4 = spd.getSheets()[1]; &lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;   // configuration&lt;/span&gt;&lt;br /&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  const data = e.parameter.data;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  const ws = sheet4;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  //--------------------------------------------&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  // RESET KML&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  //--------------------------------------------&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  if (ws.getRange(\"X2\").getValue().toUpperCase() === \"RESET\") {&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    const file = DriveApp.getFileById(fileId);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    const content = file.getBlob().getDataAsString();&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    const newContent = content.replace(/&lt;coordinates&gt;[\\s\\S]*?&lt;\\/coordinates&gt;/g,&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;                                       '&lt;coordinates&gt;\\n&lt;/coordinates&gt;');&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    file.setContent(newContent);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    ws.getRange(\"X2\").setValue(\"DONE\");&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  }&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  //--------------------------------------------&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  // Registro pausado&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  //--------------------------------------------&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  if (ws.getRange(\"AE1\").getValue() !== \"REGISTRANDO\")&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    return ContentService.createTextOutput(\"Registro de datos pausado.\");&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  //--------------------------------------------&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  // Añadir nueva fila&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  //--------------------------------------------&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  data2 = data.replace(/\\./g, \",\");&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  ws.appendRow([data2]);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  const pos = ws.getLastRow();&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  ws.getRange(pos, 2).setFormula('=SPLIT(A' + pos + ';\";\")');&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  ws.getRange(\"AH6\").setValue(ws.getRange(\"AG6\").getValue());&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  ws.getRange(pos, 20).setFormulaR1C1(&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  '=2*6371*ASIN(SQRT(' +&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  'SIN((RADIANS(RC[-10])-RADIANS(R[-1]C[-10]))/2)^2+' +&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  'COS(RADIANS(RC[-10]))*COS(RADIANS(R[-1]C[-10]))*' +&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  'SIN((RADIANS(RC[-7])-RADIANS(R[-1]C[-7]))/2)^2' +&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  '))'&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  ws.getRange(pos,19).setFormulaR1C1('=RC[1]/(RC[-1]-R[-1]C[-1])/86400');&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;   &lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  //--------------------------------------------&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  const ahora = new Date();&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  ws.getRange(pos, 18).setValue(ahora).setNumberFormat(\"hh:mm:ss\");&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  //--------------------------------------------&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  // Escritura en archivo KML (solo si está ON)&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  //--------------------------------------------&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  if (ws.getRange(\"W2\").getValue().toUpperCase() === \"ON\" ) {&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    const lat = ws.getRange(pos, 10).getValue();&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    const lon = ws.getRange(pos, 13).getValue();&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    const file2 = DriveApp.getFileById(fileId);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    const content2 = file2.getBlob().getDataAsString();&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    const newContent2 = content2.replace('&lt;coordinates&gt;', `&lt;coordinates&gt;\\n${lon},${lat}`);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    file2.setContent(newContent2);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  }&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  //--------------------------------------------&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  // Actualiza contador&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  //--------------------------------------------&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  ws.getRange(\"AG1\").setValue(pos - 31);&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  const url = \"http://fabarca.hopto.org:8000/estado\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  const celda = ws.getRange(\"AC2\");&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  try {&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  const respuesta = UrlFetchApp.fetch(url, {&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    muteHttpExceptions: true,&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    followRedirects: true,&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    timeout: 2000&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  });&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  const datos = JSON.parse(respuesta.getContentText());&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  const transmitiendo = datos.transmitiendo === true;&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  // Celda estado transmisión&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  const celdaEstado = ws.getRange(\"AC2\");&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  celdaEstado.setValue(transmitiendo);&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  if (transmitiendo) {&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    celdaEstado.setBackground(\"#00ff00\"); // verde&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  } else {&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;    celdaEstado.setBackground(\"#ff0000\"); // rojo&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  }&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  // Celda estado servidor&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  const celdaServidor = ws.getRange(\"AC7\");&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  celdaServidor.setBackground(\"#00ff00\"); // verde&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  celdaServidor.setValue(\"Servidor OK\");&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;} catch (error) {&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  const celdaServidor = ws.getRange(\"AC7\");&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  celdaServidor.setBackground(\"#ff0000\"); // rojo&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  celdaServidor.setValue(\"Servidor Flask no responde\");&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;  celdaEstado.setBackground(\"#ff0000\"); // rojo&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;}&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;}&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;br /&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; &lt;/span&gt;&lt;/p&gt;","textFeedbackInput":"Show Feedback","textFeedbackTextarea":""}</jsonProperties><odeComponentsOrder>1</odeComponentsOrder><odeComponentsProperties><odeComponentsProperty><key>visibility</key><value>true</value></odeComponentsProperty><odeComponentsProperty><key>teacherOnly</key><value>false</value></odeComponentsProperty><odeComponentsProperty><key>identifier</key><value/></odeComponentsProperty><odeComponentsProperty><key>cssClass</key><value/></odeComponentsProperty></odeComponentsProperties></odeComponent></odeComponents></odePagStructure></odePagStructures></odeNavStructure><odeNavStructure><odePageId>20260206013613BBULUM</odePageId><odeParentPageId/><pageName>Interfaz web consulta de datos</pageName><odeNavStructureOrder>6</odeNavStructureOrder><odeNavStructureProperties><odeNavStructureProperty><key>titleNode</key><value/></odeNavStructureProperty><odeNavStructureProperty><key>hidePageTitle</key><value>false</value></odeNavStructureProperty><odeNavStructureProperty><key>titleHtml</key><value/></odeNavStructureProperty><odeNavStructureProperty><key>editableInPage</key><value>false</value></odeNavStructureProperty><odeNavStructureProperty><key>titlePage</key><value>Interfaz web consulta de datos</value></odeNavStructureProperty><odeNavStructureProperty><key>visibility</key><value>true</value></odeNavStructureProperty><odeNavStructureProperty><key>highlight</key><value>false</value></odeNavStructureProperty><odeNavStructureProperty><key>description</key><value/></odeNavStructureProperty></odeNavStructureProperties><odePagStructures><odePagStructure><odePageId>20260206013613BBULUM</odePageId><odeBlockId>20260206013613MGEZAN</odeBlockId><blockName>Interfaz web</blockName><iconName/><odePagStructureOrder>1</odePagStructureOrder><odePagStructureProperties><odePagStructureProperty><key>visibility</key><value>true</value></odePagStructureProperty><odePagStructureProperty><key>teacherOnly</key><value>false</value></odePagStructureProperty><odePagStructureProperty><key>allowToggle</key><value>true</value></odePagStructureProperty><odePagStructureProperty><key>minimized</key><value>false</value></odePagStructureProperty><odePagStructureProperty><key>identifier</key><value/></odePagStructureProperty><odePagStructureProperty><key>cssClass</key><value/></odePagStructureProperty></odePagStructureProperties><odeComponents><odeComponent><odePageId>20260206013613BBULUM</odePageId><odeBlockId>20260206013613MGEZAN</odeBlockId><odeIdeviceId>20260128141621822LWQ</odeIdeviceId><odeIdeviceTypeName>text</odeIdeviceTypeName><htmlView>&lt;div class="exe-text-template"&gt;&lt;div class="textIdeviceContent"&gt;
            &lt;div class="exe-text-activity"&gt;
                &lt;div&gt;&lt;p&gt;Una vez tenemos los datos almacenado en nuestra base de datos podremos consutar los datos a través de un interfaz de consulta. Una primera aproximación podría ser (advertirá que el código está poco optimizado pero es funcional).&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&lt;!--?php&lt;/span--&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;?&gt;&lt;/span&gt;&lt;br&gt;&lt;/span&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$USER='usuario base de datos';&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$PASS='contraseña';&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$base='practicas';&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$link=mysqli_connect("localhost",$USER,$PASS);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;mysqli_select_db ($link,"practicas");&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$fechaq= date("Y")."-".date("m")."-".date("d");&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;print "&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;";&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;$datoqr="format(avg(temperatura),1),format(avg(humedad),0), format(avg(presion),0),format(avg(viento),0),format(sum(precipitacion),1),format(avg(racha),0)";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;$cabeceragr="&lt;/span&gt;";&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;else&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;print "Todas las variables\n";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;if ($dato=="humedad")&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;{&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;print "humedad\n";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;$datoq="fecha,hora,temperatura,humedad";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;$cabecera="&lt;/span&gt;";&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;$datoqr="format(avg(temperatura),1),format(avg(humedad),0)";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;$cabeceragr="&lt;/span&gt;";&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;else&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;print "Humedad\n";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;if ($dato=="lluvia")&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;{&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;print "Precipitación\n";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;$cabecera="&lt;/span&gt;";&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;$datoq="fecha,hora,precipitacion";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;$datoqr="format(sum(precipitacion),1)";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;$cabeceragr="&lt;/span&gt;";&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;else&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;print "Precipitación\n";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;if ($dato=="presion")&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;{&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;$cabecera="&lt;/span&gt;";&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;print "Presión\n";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;$datoq="fecha,hora,presion";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;$datoqr="format(avg(presion),1)";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;$cabeceragr="&lt;/span&gt;";&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;else&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;print "Presión barométrica\n";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;if ($dato=="viento")&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;{&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;print "Viento\n";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;$cabecera="&lt;/span&gt;";&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;$datoq="fecha,hora,viento";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;$datoqr="format(avg(viento),1)";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;$cabeceragr="&lt;/span&gt;";&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;else&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;print "Viento\n";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;if ($dato=="racha")&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;{&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;print "Viento\n";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;$cabecera="&lt;/span&gt;";&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;$datoq="fecha,hora,racha";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;$datoqr="format(avg(racha),1)";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;$cabeceragr="&lt;/span&gt;";&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;else&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;print "Racha\n";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;print "";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;Print "&amp;nbsp;&amp;nbsp;&amp;nbsp;Intervalo: ";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;print "&lt;select name="rango" style="\"height:" 20px;font-family:="" verdana,="" arial,="" helvética;font-size:="" 11\"="" onchange="\"reload(this.form)\""&gt;";&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;if ($rango==1) { print "Hoy\n";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;else&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;print "Hoy\n";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;if ($rango==2)&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;print "Última semana\n";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;else&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;print "Última semana\n";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;if ($rango==3)&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;print "Último mes\n";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;else&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;print "Último mes\n";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;if ($rango==4)&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;print "Últimos 3 meses\n";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;else&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;print "Últimos 3 meses\n";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;if ($rango==5)&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;print "Todo el registro\n";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;else&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;print "Todo el registro\n";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;print "&lt;/span&gt;";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;print "&amp;nbsp;&amp;nbsp;Agrupación de datos: ";&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;print "&lt;select name="grupo" style="\"width:" 90px;="" height:="" 20px;font-family:="" verdana,="" arial,="" helvética;font-size:="" 11\"="" onchange="\"reload(this.form)\""&gt;";&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;if ($grupo==1) { print &amp;nbsp;"Sin agrupar\n";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$grupoch="";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$order="";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;else&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;print "Sin agrupar\n";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;if ($grupo==2) { print "Diario\n";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;$grupoch= "group by fecha";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;$qb="fecha";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;$order="desc";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;else&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;print "Diario\n";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;if ($grupo==3) {print "Semanal\n";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;$grupoch= "group by round(datediff (fecha, \"$fechaq\")/7)";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;$qb= "abs(round(datediff (fecha, \"$fechaq\")/7)) as semana";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;$order="desc";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;else&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;print "Semanal\n";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;if ($grupo==4){ print "Mensual\n";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;$grupoch= "group by left(fecha,7)";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;$qb="left(fecha,7) as mes";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;$order="desc";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;else&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;print "Mensual\n";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;if ($grupo==5) { print "Anual\n";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;$grupoch= "group by left(fecha,4)";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;$qb="left(fecha,4) as Año";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;$order="desc";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;else&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;print "Anual\n";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;print "&lt;/span&gt;";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;print "&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;";&amp;nbsp;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$fecha= date("Y")."-".date("m")."-".date("d");&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;if ($rango==1) {&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;if ($grupo==1) $query = "SELECT $datoq FROM datosEstacion where fecha=\"$fecha\" order by id desc";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;else&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$query = "SELECT $qb,$datoqr FROM datosEstacion where fecha=\"$fecha\" $grupoch order by 1 $order";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;if ($rango==2) {&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$timestamp=date ("U") - 60*60*24*7;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$nuevo= getdate ($timestamp);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$fecha1 = $nuevo['year'].'-'.$nuevo['mon'].'-'.$nuevo['mday'];&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;if ($grupo==1) $query = "SELECT &amp;nbsp;$datoq FROM datosEstacion where fecha between \"$fecha1\" and &amp;nbsp;\"$fecha\" $grupoch order by id desc";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;else&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$query = "SELECT &amp;nbsp;$qb,$datoqr FROM datosEstacion where fecha between \"$fecha1\" and &amp;nbsp;\"$fecha\" $grupoch order by 1 $order";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;if ($rango==3) {&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$timestamp=date ("U") - 60*60*24*30;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$nuevo= getdate ($timestamp);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$fecha1 = $nuevo['year'].'-'.$nuevo['mon'].'-'.$nuevo['mday'];&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;if ($grupo==1) $query = "SELECT &amp;nbsp;$datoq FROM datosEstacion where fecha between \"$fecha1\" and &amp;nbsp;\"$fecha\" $grupoch order by 1 desc";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;else&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$query = "SELECT &amp;nbsp;$qb,$datoqr FROM datosEstacion where fecha between \"$fecha1\" and &amp;nbsp;\"$fecha\" $grupoch order by 1 $order";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;if ($rango==4) {&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$timestamp=date ("U") - 60*60*24*90;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$nuevo= getdate ($timestamp);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$fecha1 = $nuevo['year'].'-'.$nuevo['mon'].'-'.$nuevo['mday'];&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;if ($grupo==1) $query = "SELECT &amp;nbsp;$datoq FROM datosEstacion where fecha between \"$fecha1\" and &amp;nbsp;\"$fecha\" $grupoch order by id desc";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;else&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$query = "SELECT &amp;nbsp;$qb,$datoqr FROM datosEstacion where fecha between \"$fecha1\" and &amp;nbsp;\"$fecha\" $grupoch order by 1 $order";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;if ($rango==5) {&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;if ($grupo==1) $query = "SELECT &amp;nbsp;$datoq FROM datosEstacion order by id desc";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;else&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$query = "SELECT &amp;nbsp;$qb,$datoqr FROM datosEstacion $grupoch order by 1 $order";&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$fechold=0;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;//print "$query, $dato,$rango,$grupo";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$result = mysqli_query($link,$query) or die("Query failed $query");&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;print "&lt;/span&gt;&lt;/p&gt;
&lt;table class="tituloheader" align="center" width="60%"&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;";&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;print "&lt;/span&gt;&lt;/span&gt;&lt;form action="procesa.php" method="\"GET\""&gt;";&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;print "&lt;/span&gt;&lt;/span&gt;
&lt;h2&gt;&lt;span style="color: #000000;"&gt;Consulta de datos meteorológicos de la Estación SotoTech&lt;/span&gt;&lt;/h2&gt;
&lt;span style="font-family: terminal, monaco, monospace;"&gt;&lt;span style="color: #000000;"&gt;";&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;&lt;span style="color: #000000;"&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;print "&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;hr 087021="" background-color:="" height:="" 5px=""&gt;&lt;span style="color: #000000;"&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$rango= $_GET['rango'];&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$dato= $_GET['dato'];&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;$grupo= $_GET['grupo'];&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;print "Variable meteorológica: ";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;if ($rango==0 || $rango=="") $rango=1;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;if (strlen($dato)==0) $dato="todas";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;if ($grupo==0 || $grupo=="") $grupo=1;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;print "&lt;select name="dato" style="\"height:" 20px;font-family:="" verdana,="" arial,="" helvética;font-size:="" 11\"="" onchange="\"reload(this.form)\""&gt;";&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;if ($dato=="todas") { print "Todas la variables\n";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;$datoq="fecha,hora,temperatura,humedad,presion,viento,precipitacion,racha";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;$cabecera="&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/form&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class="cabecera" width="15%"&gt;Fecha&lt;/td&gt;
&lt;td class="cabecera" width="15%"&gt;Hora&lt;/td&gt;
&lt;td class="cabecera" width="15%"&gt;Temperatura&lt;/td&gt;
&lt;td class="cabecera" width="15%"&gt;Humedad&lt;/td&gt;
&lt;td class="cabecera" width="20%"&gt;Presión&lt;/td&gt;
&lt;td class="cabecera" width="20%"&gt;Viento&lt;/td&gt;
&lt;td class="cabecera" width="20%"&gt;Lluvia&lt;/td&gt;
&lt;td class="cabecera"&gt;Racha&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class="cabecera" width="15%"&gt;Tiempo&lt;/td&gt;
&lt;td class="cabecera" width="15%"&gt;Temperatura&lt;/td&gt;
&lt;td class="cabecera" width="15%"&gt;Humedad&lt;/td&gt;
&lt;td class="cabecera" width="20%"&gt;Presión&lt;/td&gt;
&lt;td class="cabecera" width="20%"&gt;Viento&lt;/td&gt;
&lt;td class="cabecera" width="20%"&gt;Lluvia&lt;/td&gt;
&lt;td class="cabecera"&gt;Racha&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class="cabecera" width="15%"&gt;Fecha&lt;/td&gt;
&lt;td class="cabecera" width="15%"&gt;Hora&lt;/td&gt;
&lt;td class="cabecera" width="15%"&gt;Temperatura&lt;/td&gt;
&lt;td class="cabecera" width="15%"&gt;Humedad&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class="cabecera" width="10"&gt;Tiempo&lt;/td&gt;
&lt;td class="cabecera" width="30%"&gt;Temperatura media&lt;/td&gt;
&lt;td class="cabecera" width="30%"&gt;Humedad media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class="cabecera" width="15%"&gt;Fecha&lt;/td&gt;
&lt;td class="cabecera" width="15%"&gt;Hora&lt;/td&gt;
&lt;td class="cabecera" width="15%"&gt;Lluvia&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class="cabecera" width="10"&gt;Tiempo&lt;/td&gt;
&lt;td class="cabecera" width="30%"&gt;Lluvia total&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class="cabecera" width="15%"&gt;Fecha&lt;/td&gt;
&lt;td class="cabecera" width="15%"&gt;Hora&lt;/td&gt;
&lt;td class="cabecera" width="15%"&gt;Presión&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class="cabecera" width="10"&gt;Tiempo&lt;/td&gt;
&lt;td class="cabecera" width="30%"&gt;Presión media&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class="cabecera" width="15%"&gt;Fecha&lt;/td&gt;
&lt;td class="cabecera" width="15%"&gt;Hora&lt;/td&gt;
&lt;td class="cabecera" width="15%"&gt;Viento&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class="cabecera" width="10"&gt;Tiempo&lt;/td&gt;
&lt;td class="cabecera" width="30%"&gt;Viento&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class="cabecera" width="15%"&gt;Fecha&lt;/td&gt;
&lt;td class="cabecera" width="15%"&gt;Hora&lt;/td&gt;
&lt;td class="cabecera" width="15%"&gt;Racha&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class="cabecera" width="10"&gt;Tiempo&lt;/td&gt;
&lt;td class="cabecera" width="30%"&gt;Racha&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;";&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;if ($grupo==1)&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;print "$cabecera";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;else&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;print "$cabeceragr";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;while ($line = mysqli_fetch_row($result)) {&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;print "&lt;/span&gt;";&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;else {&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp;$fec=explode("-",$line[0]);&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp;$fecha=$fec[2]."/".$fec[1]."/".$fec[0];&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp;print "&lt;span class="\"event_month\""&gt;$fecha&lt;/span&gt;";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;}&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; print "&lt;/span&gt;";&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; print "&lt;/span&gt;";&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; print "&lt;/span&gt;";&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; print "&lt;/span&gt;";&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; print "&lt;/span&gt;";&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; print "&lt;/span&gt;";&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; print "&lt;/span&gt;";&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; print "&lt;/span&gt;";&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; print "";&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;print "";&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;$fechold=$fech;&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;}&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;print "&lt;/span&gt;&lt;/p&gt;
&lt;table align="center" class="bodynews"&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;";&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&amp;nbsp;if ($grupo&gt;2) print "&lt;span class="\"event_month\""&gt;$line[0]&lt;/span&gt;&lt;/span&gt;&lt;/td&gt;
&lt;td align="center"&gt;&lt;span class="\"event_month\""&gt;$line[1]&lt;/span&gt;&lt;/td&gt;
&lt;td align="center"&gt;&lt;span class="\"event_month\""&gt;$line[2]&lt;/span&gt;&lt;/td&gt;
&lt;td align="center"&gt;&lt;span class="\"event_month\""&gt;$line[3]&lt;/span&gt;&lt;/td&gt;
&lt;td align="center"&gt;&lt;span class="\"event_month\""&gt;$line[4]&lt;/span&gt;&lt;/td&gt;
&lt;td align="center"&gt;&lt;span class="\"event_month\""&gt;$line[5]&lt;/span&gt;&lt;/td&gt;
&lt;td align="center"&gt;&lt;span class="\"event_month\""&gt;$line[6]&lt;/span&gt;&lt;/td&gt;
&lt;td align="center"&gt;&lt;span class="\"event_month\""&gt;$line[7]&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;";&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;print "&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;";&amp;nbsp;&lt;br&gt;&lt;span style="font-family: terminal, monaco, monospace;"&gt;print "";&lt;/span&gt;&lt;/p&gt;&lt;p class="clearfix"&gt;&lt;/p&gt;&lt;/div&gt;
            &lt;/div&gt;&lt;/div&gt;&lt;/div&gt;</htmlView><jsonProperties>{"ideviceId":"20260128141621822LWQ","textInfoDurationInput":"","textInfoDurationTextInput":"Duración","textInfoParticipantsInput":"","textInfoParticipantsTextInput":"Agrupamiento","textTextarea":"&lt;p&gt;Una vez tenemos los datos almacenado en nuestra base de datos podremos consutar los datos a través de un interfaz de consulta. Una primera aproximación podría ser (advertirá que el código está poco optimizado pero es funcional).&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;&lt;!--?php&lt;/span--&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;?&gt;&lt;/span&gt;&lt;br /&gt;&lt;/span&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$USER='usuario base de datos';&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$PASS='contraseña';&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$base='practicas';&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$link=mysqli_connect(\"localhost\",$USER,$PASS);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;mysqli_select_db ($link,\"practicas\");&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$fechaq= date(\"Y\").\"-\".date(\"m\").\"-\".date(\"d\");&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;print \"&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;\";&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; $datoqr=\"format(avg(temperatura),1),format(avg(humedad),0), format(avg(presion),0),format(avg(viento),0),format(sum(precipitacion),1),format(avg(racha),0)\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; $cabeceragr=\"&lt;/span&gt;\";&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;else&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;print \"Todas las variables\\n\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;if ($dato==\"humedad\")&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; {&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;print \"humedad\\n\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; $datoq=\"fecha,hora,temperatura,humedad\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; $cabecera=\"&lt;/span&gt;\";&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; $datoqr=\"format(avg(temperatura),1),format(avg(humedad),0)\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; $cabeceragr=\"&lt;/span&gt;\";&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;else&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;print \"Humedad\\n\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;if ($dato==\"lluvia\")&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; {&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;print \"Precipitación\\n\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; $cabecera=\"&lt;/span&gt;\";&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; $datoq=\"fecha,hora,precipitacion\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; $datoqr=\"format(sum(precipitacion),1)\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; $cabeceragr=\"&lt;/span&gt;\";&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;else&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;print \"Precipitación\\n\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;if ($dato==\"presion\")&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;{&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; $cabecera=\"&lt;/span&gt;\";&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;print \"Presión\\n\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; $datoq=\"fecha,hora,presion\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; $datoqr=\"format(avg(presion),1)\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; $cabeceragr=\"&lt;/span&gt;\";&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;else&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;print \"Presión barométrica\\n\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;if ($dato==\"viento\")&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; {&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;print \"Viento\\n\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; $cabecera=\"&lt;/span&gt;\";&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; $datoq=\"fecha,hora,viento\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; $datoqr=\"format(avg(viento),1)\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; $cabeceragr=\"&lt;/span&gt;\";&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;else&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;print \"Viento\\n\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;if ($dato==\"racha\")&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; {&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;print \"Viento\\n\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; $cabecera=\"&lt;/span&gt;\";&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; $datoq=\"fecha,hora,racha\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; $datoqr=\"format(avg(racha),1)\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; $cabeceragr=\"&lt;/span&gt;\";&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;else&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;print \"Racha\\n\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;print \"\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;Print \"   Intervalo: \";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;print \"&lt;select name=\"rango\" style=\"\\\"height:\" 20px;font-family:=\"\" verdana,=\"\" arial,=\"\" helvética;font-size:=\"\" 11\\\"=\"\" onchange=\"\\\"reload(this.form)\\\"\"&gt;\";&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;if ($rango==1) { print \"Hoy\\n\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;else&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;print \"Hoy\\n\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;if ($rango==2)&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;print \"Última semana\\n\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;else&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;print \"Última semana\\n\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;if ($rango==3)&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;print \"Último mes\\n\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;else&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;print \"Último mes\\n\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;if ($rango==4)&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;print \"Últimos 3 meses\\n\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;else&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;print \"Últimos 3 meses\\n\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;if ($rango==5)&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;print \"Todo el registro\\n\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;else&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;print \"Todo el registro\\n\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;print \"&lt;/span&gt;\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;print \"  Agrupación de datos: \";&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;br /&gt;&lt;/p&gt;\n&lt;p&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;print \"&lt;select name=\"grupo\" style=\"\\\"width:\" 90px;=\"\" height:=\"\" 20px;font-family:=\"\" verdana,=\"\" arial,=\"\" helvética;font-size:=\"\" 11\\\"=\"\" onchange=\"\\\"reload(this.form)\\\"\"&gt;\";&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;if ($grupo==1) { print  \"Sin agrupar\\n\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$grupoch=\"\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$order=\"\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;else&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;print \"Sin agrupar\\n\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;if ($grupo==2) { print \"Diario\\n\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; $grupoch= \"group by fecha\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; $qb=\"fecha\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; $order=\"desc\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;else&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; print \"Diario\\n\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;if ($grupo==3) {print \"Semanal\\n\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; $grupoch= \"group by round(datediff (fecha, \\\"$fechaq\\\")/7)\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; $qb= \"abs(round(datediff (fecha, \\\"$fechaq\\\")/7)) as semana\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; $order=\"desc\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;else&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; print \"Semanal\\n\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;if ($grupo==4){ print \"Mensual\\n\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; $grupoch= \"group by left(fecha,7)\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; $qb=\"left(fecha,7) as mes\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; $order=\"desc\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;else&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; print \"Mensual\\n\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;if ($grupo==5) { print \"Anual\\n\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; $grupoch= \"group by left(fecha,4)\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; $qb=\"left(fecha,4) as Año\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; $order=\"desc\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;else&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; print \"Anual\\n\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;print \"&lt;/span&gt;\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;print \"&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;\"; &lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$fecha= date(\"Y\").\"-\".date(\"m\").\"-\".date(\"d\");&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;if ($rango==1) {&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;if ($grupo==1) $query = \"SELECT $datoq FROM datosEstacion where fecha=\\\"$fecha\\\" order by id desc\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;else&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$query = \"SELECT $qb,$datoqr FROM datosEstacion where fecha=\\\"$fecha\\\" $grupoch order by 1 $order\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;if ($rango==2) {&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$timestamp=date (\"U\") - 60*60*24*7;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$nuevo= getdate ($timestamp);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$fecha1 = $nuevo['year'].'-'.$nuevo['mon'].'-'.$nuevo['mday'];&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;if ($grupo==1) $query = \"SELECT  $datoq FROM datosEstacion where fecha between \\\"$fecha1\\\" and  \\\"$fecha\\\" $grupoch order by id desc\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;else&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$query = \"SELECT  $qb,$datoqr FROM datosEstacion where fecha between \\\"$fecha1\\\" and  \\\"$fecha\\\" $grupoch order by 1 $order\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;if ($rango==3) {&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$timestamp=date (\"U\") - 60*60*24*30;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$nuevo= getdate ($timestamp);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$fecha1 = $nuevo['year'].'-'.$nuevo['mon'].'-'.$nuevo['mday'];&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;if ($grupo==1) $query = \"SELECT  $datoq FROM datosEstacion where fecha between \\\"$fecha1\\\" and  \\\"$fecha\\\" $grupoch order by 1 desc\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;else&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$query = \"SELECT  $qb,$datoqr FROM datosEstacion where fecha between \\\"$fecha1\\\" and  \\\"$fecha\\\" $grupoch order by 1 $order\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;if ($rango==4) {&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$timestamp=date (\"U\") - 60*60*24*90;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$nuevo= getdate ($timestamp);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$fecha1 = $nuevo['year'].'-'.$nuevo['mon'].'-'.$nuevo['mday'];&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;if ($grupo==1) $query = \"SELECT  $datoq FROM datosEstacion where fecha between \\\"$fecha1\\\" and  \\\"$fecha\\\" $grupoch order by id desc\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;else&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$query = \"SELECT  $qb,$datoqr FROM datosEstacion where fecha between \\\"$fecha1\\\" and  \\\"$fecha\\\" $grupoch order by 1 $order\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;if ($rango==5) {&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;if ($grupo==1) $query = \"SELECT  $datoq FROM datosEstacion order by id desc\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;else&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$query = \"SELECT  $qb,$datoqr FROM datosEstacion $grupoch order by 1 $order\";&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$fechold=0;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;//print \"$query, $dato,$rango,$grupo\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$result = mysqli_query($link,$query) or die(\"Query failed $query\");&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;print \"&lt;/span&gt;&lt;/p&gt;\n&lt;table class=\"tituloheader\" align=\"center\" width=\"60%\"&gt;\n&lt;tbody&gt;\n&lt;tr&gt;\n&lt;td&gt;\";&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;print \"&lt;/span&gt;&lt;/span&gt;&lt;form action=\"procesa.php\" method=\"\\"GET\\"\"&gt;\";&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;print \"&lt;/span&gt;&lt;/span&gt;\n&lt;h2&gt;&lt;span style=\"color: #000000;\"&gt;Consulta de datos meteorológicos de la Estación SotoTech&lt;/span&gt;&lt;/h2&gt;\n&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;&lt;span style=\"color: #000000;\"&gt;\";&lt;/span&gt;&lt;/span&gt;&lt;span style=\"color: #000000;\"&gt;&lt;span style=\"color: #000000;\"&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;print \"&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;hr 087021=\"\" background-color:=\"\" height:=\"\" 5px=\"\" /&gt;&lt;span style=\"color: #000000;\"&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$rango= $_GET['rango'];&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$dato= $_GET['dato'];&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;$grupo= $_GET['grupo'];&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;print \"Variable meteorológica: \";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;if ($rango==0 || $rango==\"\") $rango=1;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;if (strlen($dato)==0) $dato=\"todas\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;if ($grupo==0 || $grupo==\"\") $grupo=1;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;print \"&lt;select name=\"dato\" style=\"\\\"height:\" 20px;font-family:=\"\" verdana,=\"\" arial,=\"\" helvética;font-size:=\"\" 11\\\"=\"\" onchange=\"\\\"reload(this.form)\\\"\"&gt;\";&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;if ($dato==\"todas\") { print \"Todas la variables\\n\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; $datoq=\"fecha,hora,temperatura,humedad,presion,viento,precipitacion,racha\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; $cabecera=\"&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/form&gt;&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td class=\"cabecera\" width=\"15%\"&gt;Fecha&lt;/td&gt;\n&lt;td class=\"cabecera\" width=\"15%\"&gt;Hora&lt;/td&gt;\n&lt;td class=\"cabecera\" width=\"15%\"&gt;Temperatura&lt;/td&gt;\n&lt;td class=\"cabecera\" width=\"15%\"&gt;Humedad&lt;/td&gt;\n&lt;td class=\"cabecera\" width=\"20%\"&gt;Presión&lt;/td&gt;\n&lt;td class=\"cabecera\" width=\"20%\"&gt;Viento&lt;/td&gt;\n&lt;td class=\"cabecera\" width=\"20%\"&gt;Lluvia&lt;/td&gt;\n&lt;td class=\"cabecera\"&gt;Racha&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td class=\"cabecera\" width=\"15%\"&gt;Tiempo&lt;/td&gt;\n&lt;td class=\"cabecera\" width=\"15%\"&gt;Temperatura&lt;/td&gt;\n&lt;td class=\"cabecera\" width=\"15%\"&gt;Humedad&lt;/td&gt;\n&lt;td class=\"cabecera\" width=\"20%\"&gt;Presión&lt;/td&gt;\n&lt;td class=\"cabecera\" width=\"20%\"&gt;Viento&lt;/td&gt;\n&lt;td class=\"cabecera\" width=\"20%\"&gt;Lluvia&lt;/td&gt;\n&lt;td class=\"cabecera\"&gt;Racha&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td class=\"cabecera\" width=\"15%\"&gt;Fecha&lt;/td&gt;\n&lt;td class=\"cabecera\" width=\"15%\"&gt;Hora&lt;/td&gt;\n&lt;td class=\"cabecera\" width=\"15%\"&gt;Temperatura&lt;/td&gt;\n&lt;td class=\"cabecera\" width=\"15%\"&gt;Humedad&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td class=\"cabecera\" width=\"10\"&gt;Tiempo&lt;/td&gt;\n&lt;td class=\"cabecera\" width=\"30%\"&gt;Temperatura media&lt;/td&gt;\n&lt;td class=\"cabecera\" width=\"30%\"&gt;Humedad media&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td class=\"cabecera\" width=\"15%\"&gt;Fecha&lt;/td&gt;\n&lt;td class=\"cabecera\" width=\"15%\"&gt;Hora&lt;/td&gt;\n&lt;td class=\"cabecera\" width=\"15%\"&gt;Lluvia&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td class=\"cabecera\" width=\"10\"&gt;Tiempo&lt;/td&gt;\n&lt;td class=\"cabecera\" width=\"30%\"&gt;Lluvia total&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td class=\"cabecera\" width=\"15%\"&gt;Fecha&lt;/td&gt;\n&lt;td class=\"cabecera\" width=\"15%\"&gt;Hora&lt;/td&gt;\n&lt;td class=\"cabecera\" width=\"15%\"&gt;Presión&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td class=\"cabecera\" width=\"10\"&gt;Tiempo&lt;/td&gt;\n&lt;td class=\"cabecera\" width=\"30%\"&gt;Presión media&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td class=\"cabecera\" width=\"15%\"&gt;Fecha&lt;/td&gt;\n&lt;td class=\"cabecera\" width=\"15%\"&gt;Hora&lt;/td&gt;\n&lt;td class=\"cabecera\" width=\"15%\"&gt;Viento&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td class=\"cabecera\" width=\"10\"&gt;Tiempo&lt;/td&gt;\n&lt;td class=\"cabecera\" width=\"30%\"&gt;Viento&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td class=\"cabecera\" width=\"15%\"&gt;Fecha&lt;/td&gt;\n&lt;td class=\"cabecera\" width=\"15%\"&gt;Hora&lt;/td&gt;\n&lt;td class=\"cabecera\" width=\"15%\"&gt;Racha&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td class=\"cabecera\" width=\"10\"&gt;Tiempo&lt;/td&gt;\n&lt;td class=\"cabecera\" width=\"30%\"&gt;Racha&lt;/td&gt;\n&lt;/tr&gt;\n&lt;/tbody&gt;\n&lt;/table&gt;\n&lt;p&gt;\";&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;if ($grupo==1)&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; print \"$cabecera\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;else&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; print \"$cabeceragr\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;while ($line = mysqli_fetch_row($result)) {&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; print \"&lt;/span&gt;\";&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; else {&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;   $fec=explode(\"-\",$line[0]);&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;   $fecha=$fec[2].\"/\".$fec[1].\"/\".$fec[0];&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;   print \"&lt;span class=\"\\"event_month\\"\"&gt;$fecha&lt;/span&gt;\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; }&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;        print \"&lt;/span&gt;\";&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;        print \"&lt;/span&gt;\";&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;        print \"&lt;/span&gt;\";&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;        print \"&lt;/span&gt;\";&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;        print \"&lt;/span&gt;\";&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;        print \"&lt;/span&gt;\";&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;        print \"&lt;/span&gt;\";&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;        print \"&lt;/span&gt;\";&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;        print \"\";&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;br /&gt;&lt;/p&gt;\n&lt;p&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; print \"\";&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; $fechold=$fech;&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;print \"&lt;/span&gt;&lt;/p&gt;\n&lt;table align=\"center\" class=\"bodynews\"&gt;\n&lt;tbody&gt;\n&lt;tr&gt;\n&lt;td&gt;\";&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt; if ($grupo&gt;2) print \"&lt;span class=\"\\"event_month\\"\"&gt;$line[0]&lt;/span&gt;&lt;/span&gt;&lt;/td&gt;\n&lt;td align=\"center\"&gt;&lt;span class=\"\\"event_month\\"\"&gt;$line[1]&lt;/span&gt;&lt;/td&gt;\n&lt;td align=\"center\"&gt;&lt;span class=\"\\"event_month\\"\"&gt;$line[2]&lt;/span&gt;&lt;/td&gt;\n&lt;td align=\"center\"&gt;&lt;span class=\"\\"event_month\\"\"&gt;$line[3]&lt;/span&gt;&lt;/td&gt;\n&lt;td align=\"center\"&gt;&lt;span class=\"\\"event_month\\"\"&gt;$line[4]&lt;/span&gt;&lt;/td&gt;\n&lt;td align=\"center\"&gt;&lt;span class=\"\\"event_month\\"\"&gt;$line[5]&lt;/span&gt;&lt;/td&gt;\n&lt;td align=\"center\"&gt;&lt;span class=\"\\"event_month\\"\"&gt;$line[6]&lt;/span&gt;&lt;/td&gt;\n&lt;td align=\"center\"&gt;&lt;span class=\"\\"event_month\\"\"&gt;$line[7]&lt;/span&gt;&lt;/td&gt;\n&lt;/tr&gt;\n&lt;/tbody&gt;\n&lt;/table&gt;\n&lt;p&gt;\";&lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;print \"&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;\"; &lt;br /&gt;&lt;span style=\"font-family: terminal, monaco, monospace;\"&gt;print \"\";&lt;/span&gt;&lt;/p&gt;","textFeedbackInput":"Mostrar retroalimentación","textFeedbackTextarea":""}</jsonProperties><odeComponentsOrder>1</odeComponentsOrder><odeComponentsProperties><odeComponentsProperty><key>visibility</key><value>true</value></odeComponentsProperty><odeComponentsProperty><key>teacherOnly</key><value>false</value></odeComponentsProperty><odeComponentsProperty><key>identifier</key><value/></odeComponentsProperty><odeComponentsProperty><key>cssClass</key><value/></odeComponentsProperty></odeComponentsProperties></odeComponent></odeComponents></odePagStructure></odePagStructures></odeNavStructure><odeNavStructure><odePageId>20260206013613UOYQVL</odePageId><odeParentPageId>20260206013613QZVSJA</odeParentPageId><pageName>Bade de datos MySQL</pageName><odeNavStructureOrder>1</odeNavStructureOrder><odeNavStructureProperties><odeNavStructureProperty><key>titleNode</key><value/></odeNavStructureProperty><odeNavStructureProperty><key>hidePageTitle</key><value>false</value></odeNavStructureProperty><odeNavStructureProperty><key>titleHtml</key><value/></odeNavStructureProperty><odeNavStructureProperty><key>editableInPage</key><value>false</value></odeNavStructureProperty><odeNavStructureProperty><key>titlePage</key><value>Bade de datos MySQL</value></odeNavStructureProperty><odeNavStructureProperty><key>visibility</key><value>true</value></odeNavStructureProperty><odeNavStructureProperty><key>highlight</key><value>false</value></odeNavStructureProperty><odeNavStructureProperty><key>description</key><value/></odeNavStructureProperty></odeNavStructureProperties><odePagStructures><odePagStructure><odePageId>20260206013613UOYQVL</odePageId><odeBlockId>20260206013613AVCHOB</odeBlockId><blockName>MySQL</blockName><iconName/><odePagStructureOrder>1</odePagStructureOrder><odePagStructureProperties><odePagStructureProperty><key>visibility</key><value>true</value></odePagStructureProperty><odePagStructureProperty><key>teacherOnly</key><value>false</value></odePagStructureProperty><odePagStructureProperty><key>allowToggle</key><value>true</value></odePagStructureProperty><odePagStructureProperty><key>minimized</key><value>false</value></odePagStructureProperty><odePagStructureProperty><key>identifier</key><value/></odePagStructureProperty><odePagStructureProperty><key>cssClass</key><value/></odePagStructureProperty></odePagStructureProperties><odeComponents><odeComponent><odePageId>20260206013613UOYQVL</odePageId><odeBlockId>20260206013613AVCHOB</odeBlockId><odeIdeviceId>20260125193053933W77</odeIdeviceId><odeIdeviceTypeName>text</odeIdeviceTypeName><htmlView>&lt;div class="exe-text-template"&gt;&lt;div class="textIdeviceContent"&gt;
            &lt;div class="exe-text-activity"&gt;
                &lt;div&gt;&lt;p&gt;Desde una terminal, accederemos a la aplicación MySQL y crearemos nuestra tabla de datos registro1. Será el almacen de nuestra información.&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;img src="{{context_path}}/20260125193053933W77/mysql.png" width="822" height="442" alt=""&gt;&lt;/p&gt;
&lt;p&gt;Atención especial merece la gestión de usuarios de la base de datos, qué permisos de acceso tiene el usuario que envía los datos. El archivo PHP que crearemos después debe establecer una conexión con la base de datos. Este usuario debe tener acceso limitado a esa base de datos y solo de escritura en esa tabla. No podrá crear tablas nuevas ni borrar las existentes. Esas operaciones las debemos realizar desde la consola con el usuario de administración.&lt;/p&gt;&lt;p class="clearfix"&gt;&lt;/p&gt;&lt;/div&gt;
            &lt;/div&gt;&lt;/div&gt;&lt;/div&gt;</htmlView><jsonProperties>{"ideviceId":"20260125193053933W77","textInfoDurationInput":"","textInfoDurationTextInput":"Duración","textInfoParticipantsInput":"","textInfoParticipantsTextInput":"Agrupamiento","textTextarea":"&lt;p&gt;Desde una terminal, accederemos a la aplicación MySQL y crearemos nuestra tabla de datos registro1. Será el almacen de nuestra información.&lt;/p&gt;\n&lt;p&gt; &lt;img src=\"{{context_path}}/20260125193053933W77/mysql.png\" width=\"822\" height=\"442\" alt=\"\" /&gt;&lt;/p&gt;\n&lt;p&gt;Atención especial merece la gestión de usuarios de la base de datos, qué permisos de acceso tiene el usuario que envía los datos. El archivo PHP que crearemos después debe establecer una conexión con la base de datos. Este usuario debe tener acceso limitado a esa base de datos y solo de escritura en esa tabla. No podrá crear tablas nuevas ni borrar las existentes. Esas operaciones las debemos realizar desde la consola con el usuario de administración.&lt;/p&gt;","textFeedbackInput":"Mostrar retroalimentación","textFeedbackTextarea":""}</jsonProperties><odeComponentsOrder>1</odeComponentsOrder><odeComponentsProperties><odeComponentsProperty><key>visibility</key><value>true</value></odeComponentsProperty><odeComponentsProperty><key>teacherOnly</key><value>false</value></odeComponentsProperty><odeComponentsProperty><key>identifier</key><value/></odeComponentsProperty><odeComponentsProperty><key>cssClass</key><value/></odeComponentsProperty></odeComponentsProperties></odeComponent></odeComponents></odePagStructure></odePagStructures></odeNavStructure><odeNavStructure><odePageId>20260206013613PDXIOI</odePageId><odeParentPageId>20260206013613QZVSJA</odeParentPageId><pageName>Hoja de Cálculo Google Sheets</pageName><odeNavStructureOrder>2</odeNavStructureOrder><odeNavStructureProperties><odeNavStructureProperty><key>titleNode</key><value/></odeNavStructureProperty><odeNavStructureProperty><key>hidePageTitle</key><value>false</value></odeNavStructureProperty><odeNavStructureProperty><key>titleHtml</key><value/></odeNavStructureProperty><odeNavStructureProperty><key>editableInPage</key><value>false</value></odeNavStructureProperty><odeNavStructureProperty><key>titlePage</key><value>Hoja de Cálculo Google Sheets</value></odeNavStructureProperty><odeNavStructureProperty><key>visibility</key><value>true</value></odeNavStructureProperty><odeNavStructureProperty><key>highlight</key><value>false</value></odeNavStructureProperty><odeNavStructureProperty><key>description</key><value/></odeNavStructureProperty></odeNavStructureProperties><odePagStructures><odePagStructure><odePageId>20260206013613PDXIOI</odePageId><odeBlockId>20260206013613BZGAII</odeBlockId><blockName>Google Sheets</blockName><iconName/><odePagStructureOrder>1</odePagStructureOrder><odePagStructureProperties><odePagStructureProperty><key>visibility</key><value>true</value></odePagStructureProperty><odePagStructureProperty><key>teacherOnly</key><value>false</value></odePagStructureProperty><odePagStructureProperty><key>allowToggle</key><value>true</value></odePagStructureProperty><odePagStructureProperty><key>minimized</key><value>false</value></odePagStructureProperty><odePagStructureProperty><key>identifier</key><value/></odePagStructureProperty><odePagStructureProperty><key>cssClass</key><value/></odePagStructureProperty></odePagStructureProperties><odeComponents><odeComponent><odePageId>20260206013613PDXIOI</odePageId><odeBlockId>20260206013613BZGAII</odeBlockId><odeIdeviceId>20260125193547419IYA</odeIdeviceId><odeIdeviceTypeName>text</odeIdeviceTypeName><htmlView>&lt;div class="exe-text-template"&gt;&lt;div class="textIdeviceContent"&gt;
            &lt;div class="exe-text-activity"&gt;
                &lt;div&gt;&lt;p&gt;En ese caso, vamos a crear una hoja de cálculo en google sheets desde el workspace de google.&lt;/p&gt;
&lt;p&gt;1. Crear el proyecto de Apps Script&lt;br&gt;Entra a &lt;a href="https://script.google.com"&gt;https://script.google.com&lt;/a&gt; Haz clic en Nuevo proyecto&lt;br&gt;&lt;/p&gt;
&lt;p&gt;2. Escribir el script básico&lt;br&gt;En el archivo Code.gs, pega este ejemplo:&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;function doGet(e) {&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;&amp;nbsp; var ss = SpreadsheetApp.openById("ID_DE_TU_SHEET");&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;&amp;nbsp; var sheet = ss.getSheetByName("Datos");&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;&amp;nbsp; sheet.appendRow([&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;&amp;nbsp; &amp;nbsp; new Date(),&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;&amp;nbsp; &amp;nbsp; e.parameter.temperatura,&amp;nbsp; // o los nombres de las variables que hemos pasado por la URL.&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;&amp;nbsp; &amp;nbsp; e.parameter.humedad&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;&amp;nbsp; ]);&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;&amp;nbsp; return ContentService.createTextOutput("OK");&lt;/span&gt;&lt;br&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;}&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;Esto permite añadir datos accediendo a la URL&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: 'courier new', courier, monospace;"&gt;&lt;a href="https://script.google.com/macros/s/ID/exec?temperatura=25&amp;humedad=60"&gt;https://script.google.com/macros/s/ID/exec?temperatura=25&amp;humedad=60&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;3. Para obtener la URL del script debemos seguir los siguientes pasos.&lt;/p&gt;
&lt;p&gt;Desplegar como Aplicación web, para ello,&amp;nbsp; haz clic en Implementar → Nueva implementación&lt;br&gt;Selecciona:&lt;/p&gt;
&lt;p&gt;Tipo: Aplicación web&lt;br&gt;Descripción: (opcional)&lt;br&gt;Ejecutar como: Tú&lt;br&gt;Quién tiene acceso: Cualquiera&lt;br&gt;Haz clic en Implementar&lt;/p&gt;
&lt;p&gt;4. Autorizar permisos&lt;br&gt;Google mostrará advertencias:&lt;/p&gt;
&lt;p&gt;Revisar permisos&lt;br&gt;Selecciona tu cuenta&lt;br&gt;Avanzado → Ir a proyecto (no seguro)&lt;br&gt;Permitir&lt;/p&gt;
&lt;p&gt;5. Obtener la URL pública&lt;br&gt;Después del despliegue, Google te dará una URL como:&lt;/p&gt;
&lt;p&gt;&amp;nbsp;https://script.google.com/macros/s/AKfycbxxxx/exec&lt;/p&gt;
&lt;p&gt;Esa es la URL que usarás desde Arduino, navegador o Postman.&lt;/p&gt;&lt;p class="clearfix"&gt;&lt;/p&gt;&lt;/div&gt;
            &lt;/div&gt;&lt;/div&gt;&lt;/div&gt;</htmlView><jsonProperties>{"ideviceId":"20260125193547419IYA","textInfoDurationInput":"","textInfoDurationTextInput":"Duration","textInfoParticipantsInput":"","textInfoParticipantsTextInput":"Grouping","textTextarea":"&lt;p&gt;En ese caso, vamos a crear una hoja de cálculo en google sheets desde el workspace de google.&lt;/p&gt;\n&lt;p&gt;1. Crear el proyecto de Apps Script&lt;br /&gt;Entra a &lt;a href=\"https://script.google.com\"&gt;https://script.google.com&lt;/a&gt; Haz clic en Nuevo proyecto&lt;br /&gt;&lt;/p&gt;\n&lt;p&gt;2. Escribir el script básico&lt;br /&gt;En el archivo Code.gs, pega este ejemplo:&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;function doGet(e) {&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;  var ss = SpreadsheetApp.openById(\"ID_DE_TU_SHEET\");&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;  var sheet = ss.getSheetByName(\"Datos\");&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;  sheet.appendRow([&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;    new Date(),&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;    e.parameter.temperatura,  // o los nombres de las variables que hemos pasado por la URL.&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;    e.parameter.humedad&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;  ]);&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;  return ContentService.createTextOutput(\"OK\");&lt;/span&gt;&lt;br /&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;}&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;Esto permite añadir datos accediendo a la URL&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;&lt;span style=\"font-family: 'courier new', courier, monospace;\"&gt;&lt;a href=\"https://script.google.com/macros/s/ID/exec?temperatura=25&amp;humedad=60\"&gt;https://script.google.com/macros/s/ID/exec?temperatura=25&amp;humedad=60&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;p&gt;3. Para obtener la URL del script debemos seguir los siguientes pasos.&lt;/p&gt;\n&lt;p&gt;Desplegar como Aplicación web, para ello,  haz clic en Implementar → Nueva implementación&lt;br /&gt;Selecciona:&lt;/p&gt;\n&lt;p&gt;Tipo: Aplicación web&lt;br /&gt;Descripción: (opcional)&lt;br /&gt;Ejecutar como: Tú&lt;br /&gt;Quién tiene acceso: Cualquiera&lt;br /&gt;Haz clic en Implementar&lt;/p&gt;\n&lt;p&gt;4. Autorizar permisos&lt;br /&gt;Google mostrará advertencias:&lt;/p&gt;\n&lt;p&gt;Revisar permisos&lt;br /&gt;Selecciona tu cuenta&lt;br /&gt;Avanzado → Ir a proyecto (no seguro)&lt;br /&gt;Permitir&lt;/p&gt;\n&lt;p&gt;5. Obtener la URL pública&lt;br /&gt;Después del despliegue, Google te dará una URL como:&lt;/p&gt;\n&lt;p&gt; https://script.google.com/macros/s/AKfycbxxxx/exec&lt;/p&gt;\n&lt;p&gt;Esa es la URL que usarás desde Arduino, navegador o Postman.&lt;/p&gt;","textFeedbackInput":"Mostrar retroalimentación","textFeedbackTextarea":""}</jsonProperties><odeComponentsOrder>1</odeComponentsOrder><odeComponentsProperties><odeComponentsProperty><key>visibility</key><value>true</value></odeComponentsProperty><odeComponentsProperty><key>teacherOnly</key><value>false</value></odeComponentsProperty><odeComponentsProperty><key>identifier</key><value/></odeComponentsProperty><odeComponentsProperty><key>cssClass</key><value/></odeComponentsProperty></odeComponentsProperties></odeComponent></odeComponents></odePagStructure></odePagStructures></odeNavStructure><odeNavStructure><odePageId>20260206013613HPPSVL</odePageId><odeParentPageId>20260206013613XUUSJH</odeParentPageId><pageName>Envio datos a google sheetss</pageName><odeNavStructureOrder>1</odeNavStructureOrder><odeNavStructureProperties><odeNavStructureProperty><key>titleNode</key><value/></odeNavStructureProperty><odeNavStructureProperty><key>hidePageTitle</key><value>false</value></odeNavStructureProperty><odeNavStructureProperty><key>titleHtml</key><value/></odeNavStructureProperty><odeNavStructureProperty><key>editableInPage</key><value>false</value></odeNavStructureProperty><odeNavStructureProperty><key>titlePage</key><value>Envio datos a google sheetss</value></odeNavStructureProperty><odeNavStructureProperty><key>visibility</key><value>true</value></odeNavStructureProperty><odeNavStructureProperty><key>highlight</key><value>false</value></odeNavStructureProperty><odeNavStructureProperty><key>description</key><value/></odeNavStructureProperty></odeNavStructureProperties><odePagStructures><odePagStructure><odePageId>20260206013613HPPSVL</odePageId><odeBlockId>20260206013613MLIOKN</odeBlockId><blockName>Text</blockName><iconName/><odePagStructureOrder>1</odePagStructureOrder><odePagStructureProperties><odePagStructureProperty><key>visibility</key><value>true</value></odePagStructureProperty><odePagStructureProperty><key>teacherOnly</key><value>false</value></odePagStructureProperty><odePagStructureProperty><key>allowToggle</key><value>true</value></odePagStructureProperty><odePagStructureProperty><key>minimized</key><value>false</value></odePagStructureProperty><odePagStructureProperty><key>identifier</key><value/></odePagStructureProperty><odePagStructureProperty><key>cssClass</key><value/></odePagStructureProperty></odePagStructureProperties><odeComponents><odeComponent><odePageId>20260206013613HPPSVL</odePageId><odeBlockId>20260206013613MLIOKN</odeBlockId><odeIdeviceId>20260125190643803RGZ</odeIdeviceId><odeIdeviceTypeName>text</odeIdeviceTypeName><htmlView>&lt;div class="exe-text-template"&gt;&lt;div class="textIdeviceContent"&gt;
            &lt;div class="exe-text-activity"&gt;
                &lt;div&gt;&lt;p&gt;&lt;img src="{{context_path}}/20260125190643803RGZ/images_1.jfif" width="333" height="151" alt=""&gt;&lt;/p&gt;
&lt;p&gt;La variante que proponemos en este caso es enviar los datos a la hoja de cálculo google sheets. El procedimiento es idéntico al descrito en el apartado anterior, se trata de crear la URL con los datos adecuados. Lo único que cambia es la construcción de la URL que debe contener la dirección del script que gestionará nuestro envío de datos. Cuando se genere la implementación Web de la hoja de cálculo se nos proporciona una URL que será la que usemos en nuestra solicitud GET.&lt;/p&gt;
&lt;p&gt;Si por ejemplo la URL es &lt;a href="https://script.google.com/macros/s/AKfycFSFH4YRO9I77udjfkmxmqsnJFSKJHJDDFHKJKkj8967ioKHLPOjhlj667hFJkL/exec"&gt;https://script.google.com/macros/s/AKfycFSFH4YRO9I77udjfkmxmqsnJFSKJHJDDFHKJKkj8967ioKHLPOjhlj667hFJkL/exec&lt;/a&gt;, esto corresponde al dominio, es decir, para enviar las variables a nuestra hoja habría que añadir : ?var1=dato1&amp;var2=dato2. Así quedaría nuestra URL: &lt;a href="https://script.google.com/macros/s/AKfycFSFH4YRO9I77udjfkmxmqsnJFSKJHJDDFHKJKkj8967ioKHLPOjhlj667hFJkL/exec?temperatura=10.23&amp;humedad=89.2"&gt;https://script.google.com/macros/s/AKfycFSFH4YRO9I77udjfkmxmqsnJFSKJHJDDFHKJKkj8967ioKHLPOjhlj667hFJkL/exec?temperatura=10.23&amp;humedad=89.2&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;En el apartado correspondiente veremos cómo rescatar los valores de la URL y cómo añadirlos automáticamente a nuestra hoja de cálculo.&lt;/p&gt;&lt;p class="clearfix"&gt;&lt;/p&gt;&lt;/div&gt;
            &lt;/div&gt;&lt;/div&gt;&lt;/div&gt;</htmlView><jsonProperties>{"ideviceId":"20260125190643803RGZ","textInfoDurationInput":"","textInfoDurationTextInput":"Duración","textInfoParticipantsInput":"","textInfoParticipantsTextInput":"Agrupamiento","textTextarea":"&lt;p&gt;&lt;img src=\"{{context_path}}/20260125190643803RGZ/images_1.jfif\" width=\"333\" height=\"151\" alt=\"\" /&gt;&lt;/p&gt;\n&lt;p&gt;La variante que proponemos en este caso es enviar los datos a la hoja de cálculo google sheets. El procedimiento es idéntico al descrito en el apartado anterior, se trata de crear la URL con los datos adecuados. Lo único que cambia es la construcción de la URL que debe contener la dirección del script que gestionará nuestro envío de datos. Cuando se genere la implementación Web de la hoja de cálculo se nos proporciona una URL que será la que usemos en nuestra solicitud GET.&lt;/p&gt;\n&lt;p&gt;Si por ejemplo la URL es &lt;a href=\"https://script.google.com/macros/s/AKfycFSFH4YRO9I77udjfkmxmqsnJFSKJHJDDFHKJKkj8967ioKHLPOjhlj667hFJkL/exec\"&gt;https://script.google.com/macros/s/AKfycFSFH4YRO9I77udjfkmxmqsnJFSKJHJDDFHKJKkj8967ioKHLPOjhlj667hFJkL/exec&lt;/a&gt;, esto corresponde al dominio, es decir, para enviar las variables a nuestra hoja habría que añadir : ?var1=dato1&amp;var2=dato2. Así quedaría nuestra URL: &lt;a href=\"https://script.google.com/macros/s/AKfycFSFH4YRO9I77udjfkmxmqsnJFSKJHJDDFHKJKkj8967ioKHLPOjhlj667hFJkL/exec?temperatura=10.23&amp;humedad=89.2\"&gt;https://script.google.com/macros/s/AKfycFSFH4YRO9I77udjfkmxmqsnJFSKJHJDDFHKJKkj8967ioKHLPOjhlj667hFJkL/exec?temperatura=10.23&amp;humedad=89.2&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;En el apartado correspondiente veremos cómo rescatar los valores de la URL y cómo añadirlos automáticamente a nuestra hoja de cálculo.&lt;/p&gt;","textFeedbackInput":"Mostrar retroalimentación","textFeedbackTextarea":""}</jsonProperties><odeComponentsOrder>1</odeComponentsOrder><odeComponentsProperties><odeComponentsProperty><key>visibility</key><value>true</value></odeComponentsProperty><odeComponentsProperty><key>teacherOnly</key><value>false</value></odeComponentsProperty><odeComponentsProperty><key>identifier</key><value/></odeComponentsProperty><odeComponentsProperty><key>cssClass</key><value/></odeComponentsProperty></odeComponentsProperties></odeComponent></odeComponents></odePagStructure></odePagStructures></odeNavStructure></odeNavStructures></ode>
